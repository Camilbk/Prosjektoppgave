\documentclass[10pt]{article}
\usepackage[a4paper, total={6in, 8in}]{geometry}
\usepackage[]{inputenc}
\usepackage{latexsym}
\setlength{\parskip}{1em}                   % Paragrapgh spacing
\setlength{\parindent}{0em}
\usepackage{amsmath}
\usepackage{pgfplots}
\pgfplotsset{compat=newest}
\usepgfplotslibrary{fillbetween}
\usepackage{amsfonts}
\usepackage{enumerate}
\usepackage{mathtools}
\usepackage[export]{adjustbox}
\usepackage{wrapfig}
\usepackage{chngcntr}
\usepackage{float}
\usepackage{todonotes}
\usepackage{xr}
\usepackage{verbatim} 
\usepackage{caption}
\usepackage{subcaption}
\usepackage{tikz}
\pgfplotsset{compat=1.17}
\usepackage{csquotes}
%\usepackage[dvipsnames]{xcolor}
\usetikzlibrary{ decorations.markings}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{definition}{Definition}[section]
\newtheorem{corollary}{Corollary}[theorem]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}{Proposition}[theorem]
%\newtheorem*{remark}{Remark}

\usepackage[english]{babel}
\usepackage{biblatex}
\addbibresource{mylib.bib}

\numberwithin{equation}{section}
\pagenumbering{gobble}

\title{A brief endeavour into traffic modelling with phase transitions}

\author{Camilla Balestrand Klemetsen}

\date{Spring 2021}

\begin{document}

\maketitle
%\addFrontPage
\newpage
\pagenumbering{roman}
%\begin{abstract}
%    PDEs are very interesting :-)) %and cool
%\end{abstract}

%\newpage

\tableofcontents 

\newpage
\pagenumbering{arabic}

\section{Introduction}
A partial differential equation (PDE) contains unknown functions of several variables, and their partial derivatives. These equations are often used in physics and formulated to solve problems of multiple variables, like the spread of heat or waves in a medium, electrostatics- and dynamics, fluid mechanics and many more. It turns out that many physical phenomena can be described by the same generalised mathematical equations, and thus may be governed by the same dynamics.

The behaviour of traffic can be both complex and non-linear. It depends on the amount of vehicles, the speed limits and the individual drivers. Many attempts have been made to produce a mathematical model for traffic flow. A well known approach is the fluid-dynamic model introduced in the $50$s by Lighthill, Whitham and Richards (LWR), where the idea was that the flow of water also could model the flow of traffic. It was simple, and allowed for many phenomena like queue formation and evolution. Since then, many more contributions has been made, but none have been able to accurately describe and model traffic. We are still on the hunt for a more accurate model which can explain the experimental features which we see in real traffic \cite{KernerHelbing}. Today, we see an increasing number of vehicles in modern cities and traffic networks. The presence of traffic lights, roundabouts and stop signs affects the flow of traffic and may lead to hard congestion and bottlenecks. This greatly affects productivity and pollution and more, and thus solutions to these challenges will have socio-economic impact \cite{GaravelloMauro2006Tfon}. Where to place traffic lights or roundabouts, exits and overpasses is one of the main goals in our understanding of traffic. We aim to maximise traffic flow and minimise congestion, accidents and pollution \cite{GaravelloMauro2006Tfon}.
%Even in every- day phenomena like traffic jams on heavily congested roads, we experi- ence shock waves when there is an accumulation of cars. The shocks do not come from collisions of cars, but rather from a rapid change in the density of cars..

The goal is to find a model for traffic flow, and show that under certain conditions there exists a unique solution to the general initial value problem. The Front Tracking algorithm, see \cite{HoldenH.Helge2015Ftfh}, is the key to show existence and uniqueness for the Cauchy problem in both the scalar- and the systems case.  The essence of Front Tracking is to use the solution of the Riemann problem to construct a piece-wise analytical solution that converges to the global analytical solution. Therefore, if we can first show a solution to the Riemann problem, we have a good starting point to show the solution to the Cauchy problem. We will here only focus on the solution to the Riemann problem, and only include theory relevant for solving the Riemann problem. 

\newpage
% ----------------------------------------
% ----------------------------------------
% ----------------------------------------

\section{Non-Linear Hyperbolic Conservation laws}
Imagine looking down on a motorway. Below we can see cars entering, driving along and then exiting the motorway. If a queue forms, we have a high density of cars, and a decline in average speed of the cars.  And if there is no queue the density of cars can be very low. We can describe the flow of cars on the motorway mathematically, like the flow of a fluid,  where $\Omega$ is the motorway and the entrances and exits are on parts of $\partial \Omega$. 

\begin{wrapfigure}[11]{L}{0.3\textwidth}
    \begin{center}
        \begin{tikzpicture}
         \filldraw[fill=cyan!10!white, draw=black!50] plot [smooth cycle, tension = 2] coordinates { (0,0) (2,0) (1.5,2.5)};
         \node at (-0.5,0.5) {$\partial \Omega$};
         \node at (1,1) {$\Omega$};
        \draw[->] (2,2) -- (2.5,2.5);
        \draw[->] (0.9,2.1) -- (0.6,2.6);
        \draw[->] (0.2,1) -- (-0.3,1.2);
        \draw[->] (0.2,-0.2) -- (-0.3,-0.4);
        \draw[->] (2.1,0.7) -- (2.7, 0.6);
        \draw[->] (1.5,-0.3) -- (2, -0.6);
        \draw[->] (0.7,-0.8) -- (0.6, -1.3);
       \end{tikzpicture}
    \caption{Domain  $\Omega$.}
    \label{Fig:ConservationLaws/Domain}
    \end{center}
\end{wrapfigure}{}
%We will frequently use the following notation. 
%\begin{center}
%\begin{itemize}
%  \item[] $\mathbb{N}$ the set of natural numbers, including 0.
%  \item[]  $\mathbb{Q}$ the set of rational numbers.
%  \item[]  $\mathbb{R}$ the set of real numbers.
%  \item[]  $L_{loc}^p $ the set of locally integrable functions.
%  \item[]  $C^0 $ the set of continuous functions.
%  \item[]  $C^1 $ the set of continuous and differentiable functions.
%\end{itemize}
%\end{center}

Let $\Omega \subseteq \mathbb{R}$ and assume $\Omega$ to be an arbitrary bounded domain with piece-wise $C^1$ boundary $\partial \Omega$. We have a fluid in $\Omega$ with density $\rho = \rho(\boldsymbol{x}, t)$ and velocity $v = v(\boldsymbol x, t)$, and we can describe the the fluid inside the domain as follows:
\begin{equation*}
    \underbrace{\frac{d}{dt} \int_{\Omega} \rho dx }_{ \text{The total change of mass over time}}  = \underbrace{\int_{\partial \Omega} (\rho v) \cdot n ds }_{\text{The flow of mass over the boundary}}
\end{equation*}
Assuming $\frac{\partial \rho}{\partial t}$ is continuous in time and space, we use Leibniz rule and move the differentiation inside the integral. Furthermore, using the divergence theorem on the right hand side: 
\begin{equation*}
    \int_{\Omega} \frac{\partial \rho}{\partial t} dx   = - \int_{\Omega} \nabla \cdot (\rho v)dx 
\end{equation*}
\begin{equation*}
    \int_{\Omega} \big ( \frac{\partial \rho}{\partial t}  + \nabla \cdot (\rho v) \big ) dx   = 0.
\end{equation*}
And since the domain is arbitrary and sufficiently smooth: 
\begin{equation}
    \frac{\partial \rho}{\partial t}  + \nabla \cdot (\rho v) = 0.
\label{Burgers}
\end{equation}
One should also notice that only two simple assumptions were made, conservation of mass, and sufficient smoothness. We can generalise this formulation for a conserved quantity $u \in \mathbb{R}^n$ with flux $ f \in \mathbb{R}^m$ 
\begin{equation}
    u_t + f(u)_x = 0, 
    \label{GeneralEquation}
\end{equation}
where the flux function $f(u)$ give rise to different models. We call equations of the form (\ref{GeneralEquation}) non-linear conservation laws, if $f(u)$ is non-linear. The one derived above, equation (\ref{Burgers}), is named the Lighthill-Whitham-Richards (LWR) model \cite{LWROrig}. We also have systems of equations, which leads to models like the Payne-Whitham Model, the Aw-Rascle Model, and multi-population models a long with multi-lane models. 

\paragraph{The Rankine-Hugoniot condition.}
When given a non-linear conservation law of the form (\ref{GeneralEquation}), our first instinct is to solve it the \textit{classical} way, by method of characteristics. However, in many cases we cannot expect to find classical solutions for all times using this method, as often the solution evolves into a multi-valued function of $x$. Figure \ref{Fig:Multivalued} shows the characteristics of a solution $u(x,t)$ to the equation (\ref{GeneralEquation}). For $t < t_0$ the characteristic lines do not intersect, and we have a classical solution. For $t \geq t_0$ the lines intersect and the classical solution can not exist. 
\begin{figure}
\begin{center}
\input{Figures/ConservationLaws/Multivalued}
\caption{Non-classical solution using method of characteristics.}
\label{Fig:Multivalued}
\end{center}
\end{figure}
Therefore, we extend our admissible set of solutions in order to allow such discontinuities; so-called weak solutions \cite{HoldenH.Helge2015Ftfh}. 

Consider the model equation (\ref{GeneralEquation}) and define $\phi \in C_0^{\infty}(\Omega \times [0, T])$ have compact support, and assume initial condition $u|_{t=0} = u_0 $. Multiplying with the test function $\phi$, and integrating by parts over an arbitrary domain $[0,T] \times \Omega \subseteq \mathbb{R}$, we obtain
\begin{align}
    0 &= \int_0^T \int_{\Omega} (u_t + f(u)_x)\phi dxdt \nonumber \\
      &= \int_0^T \int_{\Omega_c} (\cdot) dxdt \nonumber \\ 
      &= \int_0^T \int_{\Omega} (u \phi_t + f(u)\phi_x) dxdt + \int_{\Omega} u_0 \phi(x,0) dx. 
    \label{Weak form}
\end{align}
Note that, as $\phi$ has compact support, the boundary terms vanish. Also we no longer have a requirement on $u$ and $f(u)$ to be differentiable. And lastly note that if the equation (\ref{GeneralEquation}) admits a classical solution $u$, then $u$ will also be a solution to the weak formulation, equation (\ref{Weak form}). Does this weak solution allow for the discontinuities we require?

Assume a discontinuity along a smooth curve $\Gamma : x = x(t)$, which is differentiable in a neighbourhood of $x(t)$, and that the equation (\ref{GeneralEquation}) admits a classical solution outside the discontinuity. Now we choose a neighbourhood $D = D_1 \cup D_2$ around the point $(x(t), t)$, see Figure \ref{fig:ConservationLaws/RHIsolated_disc}, and a test function with compact support in D. We investigate the weak solution on $D$:
\begin{align*}
    0 &= \iint_D( u \phi_t + f(u)\phi_x) dx dt \\
      &= (\iint_{D_1}  +  \iint_{D_2}  )( (u \phi_t + f(u)\phi_x) + \phi \underbrace{(u_t + f(u)_x )}_{=0} ) dxdt\\
      &= (\iint_{D_1}  +  \iint_{D_2}  ) ( (\phi u )_t + (\phi f(u))_x ) dxdt \\
      &= (\iint_{D_1}  +  \iint_{D_2}  ) (\partial_t, \partial_x)\cdot (\phi u, \phi f(u)) dx dt \\
      &= (\int_{\partial D_1}  +  \int_{\partial D_2}  ) (\phi u, \phi f(u)) \cdot n ds.
\end{align*}
In the last step Greens theorem was used to move from the whole domain $D$ onto the boundary. We have $\phi = 0 $ on $\partial D_1, \partial D_2$, except on $\Gamma$. Parameterising $\Gamma$ using the tangent $T = (x(t), 1)$ with normal vector $\vec{n} = (-1, x'(t))$, we get
\begin{equation*}
    0 = \int_{\Gamma} (\phi f(u), \phi u) \cdot (-1, x'(t)) dt.
\end{equation*}
\begin{wrapfigure}[16]{l}{0.4\textwidth}
    \centering
    \input{Figures/ConservationLaws/IsolatedDisc}
    \caption{An isolated discontinuity.}
    \label{fig:ConservationLaws/RHIsolated_disc}
\end{wrapfigure}{}
Now we want to approach the discontinuity from both sides, so we define $u_l = \lim_{\epsilon \to 0} u(x(t) - \epsilon, t)$, $u_r = \lim_{\epsilon \to 0} u(x(t) + \epsilon, t)$.
\begin{align*}
    0 &= \int_{\Gamma} (\phi x'(t) (u_r - u_l) - \phi( f(u_r) - f(u_l))  dt \\
      &= \int_{\Gamma} \phi (  f(u_r) - f(u_l) - x'(t)(u_r - u_l) ) dt.
\end{align*}
And as we have defined $\phi \geq 0 $ for all test functions, we must have
\begin{equation*}
    f(u_r) - f(u_l)  = x'(t)(u_r - u_l) 
\end{equation*}
\begin{equation}
    [f] = s[u], \quad s := x'(t) 
    \label{Eq:RH}
\end{equation}
where we have used the notation $[u] = u_r - u_r$ for the jump in a quantity $u$. This, (\ref{Eq:RH}), is called the \textit{The Rankine-Hugoniot condition}, and it describes the conservation of mass $u$ across a discontinuity. It gives a condition on discontinuities of weak solutions (\ref{Weak form}), and it relates left state $(u_l)$ and right state $(u_r)$ with the speed $x'(t)$ of the \textit{shock wave}. Also, note that this derivation of the Rankine-Hugoniot condition can easily be extended to higher dimensions, and (\ref{Eq:RH}) is a system of $n$ scalar equations \cite{GaravelloMauro2006Tfon}.

We have now seen that the weak solution permits certain discontinuities. However, we loose uniqueness with weak solutions, as the equation no longer needs to hold point-wise, and we need to find a way to restore it. We do that by introducing entropy conditions, but first we take a look at the Riemann problem.
% ---------------------------------------------------------------------
% ---------------------------------------------------------------------
% ---------------------------------------------------------------------

\subsection{The Riemann Problem}
We turn our attention to the Riemann problem. The initial value problem is the Riemann problem for conservation laws (\ref{Eq: RP}). This can can be thought of as gas in a tube, separated by a membrane, see Figure \ref{Fig:riemann_tube}. On each side of the membrane we have a gas with different density.
\begin{equation}
 u_t + f(u)_x = 0,  \quad u|_{t = 0 } = \begin{cases} u_l & \text{if $x \leq 0$,}\\ u_r & \text{if $x>0$.} 
 \label{Eq: RP}
 \end{cases}
\end{equation}
\begin{wrapfigure}[10]{r}{0.5\textwidth}
    \begin{center}
        \begin{tikzpicture}
        \draw   [thin, shade,top color=cyan!20!white]  (0,-0.5) -- ++(2,0) 
    arc(-90:90:0.2 and 0.5) -- ++(-2,0) 
    arc(90:-90:0.2 and 0.5)--cycle;
        \draw   [thin, shade,top color=lime!50!white]  (2,-0.5) -- (4,-0.5) 
        arc(-90:90:0.2 and 0.5) -- ++(-2,0)
        arc(90:-90:0.2 and 0.5) --  cycle;
    \draw[thin, shade, top color=cyan!10!white] (0,0) ellipse(0.2 and 0.5);
    \draw[dotted] (2,0) ellipse(0.2 and 0.5);
        \node at (1,0.2) {$u_l$};
        \node at (3,0.2) {$u_r$};
        \draw[->] (-0.5,0) -- (5,0) node[anchor=south east] {$u$};
        \end{tikzpicture}
    \caption{Initial constant state.}
    \label{Fig:riemann_tube}
    \end{center}
\end{wrapfigure}

Note that equation is scale invariant. This means that if we scale u with some parameter, it does not change the equation or the solution. $v(x,t) = u(\alpha x, \alpha t) \rightarrow \alpha u(t,x)$. Therefore we can introduce a scaling on $u(x,t) = \omega (x/t) $, $ \xi = x/t$. We have either sharp discontinuities \textit{shocks} from $u_l$ to $u_r$ or solutions that smooth out \textit{rarefactions} from point $u_l$ to $u_r$. 
 \begin{equation*}
     \begin{split}
         0 &= u_t + f(u)_x = u_t + df(u)u_x \\
           &= \dot \omega( -\frac{x}{t^2}) + df( \omega) \dot \omega t^{-1} \\
           &= \frac{x}{t}(  df( \omega) \dot \omega - x/t \dot \omega ).
     \end{split}
 \end{equation*}
 And we have the resulting equation 
 \begin{equation}
     df( \omega) \dot \omega =  \xi \dot \omega.
     \label{Eq:scaledEq}
 \end{equation}

\subsubsection{The scalar conservation law}
Let $u,f \in \mathbb{R}$. We can then cancel $\dot \omega $ in (\ref{Eq:scaledEq}), and if $f'$ is strictly monotone, we can find $u(x,t) = w(x/t) = (f')^{-1}(\frac{x}{t})$. 
To ensure strict monotonicity, we introduce the lower convex envelope $f_{\smile}(u) = \sup\{g(u) : g\leq f, \quad  g \quad \textit{convex on}\quad [u_l, u_r]\} $. We claim we have the solution for $u_r > u_l$:
 \begin{equation}
     u(x,t) = \begin{cases} u_l & \text{for $x < f'_{\smile} (u_l)t$,}\\
                            (f'_{\smile} )^{-1}(\frac{x}{t}) & \text{for $f'_{\smile} (u_l)t$} < x < f'_{\smile} (u_r)t,\\ 
                            u_r & \text{for $x > f'_{\smile} (u_r)t$}. 
     \end{cases}
     \label{Eq:ScalarRiemannSol}
 \end{equation}
We can also construct the upper concave envelope, in case $u_r < u_l$, by transforming $x \mapsto -x$. We now have $-f(u)$, and the lower convex envelope of $-f$, which is the upper concave envelope from $u_l$ to $u_r$.  Where $f_{\frown}(u) = \inf\{g(u) : g\leq f, \quad g \quad \textit{concave on} \quad  [u_r, u_l]\} $. And the principle is the same, replacing with $f_{\frown}(u)$ in (\ref{Eq:ScalarRiemannSol}). 

  \begin{minipage}{\linewidth}
  \centering
  \begin{minipage}{0.45\linewidth}
      \begin{figure}[H]
          \includegraphics[clip, trim=2cm 14cm 2cm 2cm, width=0.99\textwidth]{Figures/ConservationLaws/convex_envelope.pdf}
          \caption{The convex envelope of $f$.}
          \label{Fig:covexenvelope}
      \end{figure}
  \end{minipage}
  \hspace{0.05\linewidth}
  \begin{minipage}{0.45\linewidth}
      \begin{figure}[H]
          \includegraphics[clip, trim=2cm 14cm 2cm 2cm, width=0.99\textwidth]{Figures/ConservationLaws/convex_derivative.pdf}
          \caption{The derivative of the convex envelope of $f$.}
          \label{Fig:derivativeOfEnvelope}
      \end{figure}
  \end{minipage}
\end{minipage}  

 It turns out that this simple idea is the key to solving the Riemann problem for scalar conservation laws. Now $f''_{\smile, \frown} \geq 0$ and $f'_{\smile, \frown} $ is non-decreasing. This allows us to take the inverse regardless of the shape of $f$, and permitting Rankine-Hugoniot discontinuities where $f'_{\smile, \frown} $ is constant. A discontinuity that satisfies the Rankine-Hugoniot entropy condition is called a \textit{shock wave}, and the continuous parts of (\ref{Eq:ScalarRiemannSol}) are called \textit{rarefaction waves} \cite{HoldenH.Helge2015Ftfh}. Now (\ref{Eq:ScalarRiemannSol}) makes sense for both rarefactions and shocks. If $f \in C^2$ has finitely many inflection points, there will be finitely many intervals alternating $f_{\smile, \frown} $ and $f(u)$. We construct the solution $u(\cdot, t)$ of finitely many intervals using these fluxes. This $u$, it turns out, is a weak solution as it satisfies (\ref{GeneralEquation}) and the so called \textit{travelling wave condition}. Notice we have the same derivative at $u_2$ and $u_3$, see Figure \ref{Fig:covexenvelope}, \ref{Fig:derivativeOfEnvelope} so Rankine-Hugoniot is satisfied as well. We state the result below
\begin{theorem}
The initial value problem
\begin{equation*}
    u_t + f(u)_x = 0,  \quad u|_{t = 0 } = \begin{cases} u_l & \text{for $x \leq 0$,}\\ u_r & \text{for $x>0$.} 
 \end{cases}
\end{equation*}
 with a flux function $f(u)$ such that $f_{\smile,\frown} \neq f$ on finitely many intervals, alternating with intervals where they coincide, has a weak solution given by the equation (\ref{Eq:ScalarRiemannSol}) if $u_l > u_r$. And if $u_r > u_l$, we construct a concave envelope.  
\label{RP_Kruzkov_sol}
\end{theorem} For the proof, along with the Kružkov theory, see Chapter $2$ in \cite{HoldenH.Helge2015Ftfh}.


% ---------------------------------------------
% ---------------------------------------------

\subsubsection{The conservation law for systems }
Let $u, f \in \mathbb{R}^n$ and  $ df(u)$ be the non-linear Jacobian matrix of the system. However, in this case we cannot cancel $ \dot \omega$ in (\ref{Eq:scaledEq}) as in the scalar case, and we are left with an eigenvalue problem. We assume that the Jacobian $df(u)$ has $n$ real eigenvalues 
\begin{equation}
    df(u)r_j(u) = \lambda_j(u)r_j(u), \quad \lambda_j(u) \in \mathbb{R}, \quad j = 1, \dots, n. 
    \label{Eq:Eig.val problem}
\end{equation}
If the eigenvalues $\lambda_1 \leq \lambda_2 \leq \dots \leq \lambda_n $ are real, we have a hyperbolic system. If the eigenvalues are distinct, the system is strictly hyperbolic \cite{HoldenH.Helge2015Ftfh}. 

\paragraph{Rarefaction waves.}
From the assumptions of the Riemann problem (\ref{Eq: RP}), and the assumptions on the flux function (\ref{Eq:Eig.val problem}) we have the following \begin{equation*}
     df( \omega) \dot \omega =  \xi \dot \omega,
\end{equation*} \begin{equation}
    \begin{cases}
    \omega( \lambda_j( u_l) ) = u_l, \\
    \omega( \lambda_j( u_r) ) = u_r, \\
    \end{cases}
    \quad \quad
    \begin{cases}
    \dot \omega( \xi ) = r_j( \omega(\xi)), \\
    \lambda_j (\omega(\xi)) = \xi. \\
    \end{cases}
    \label{Eq:SystemsAssumptions}
\end{equation}
From (\ref{Eq:SystemsAssumptions}), for a fixed time $t$ the function $\omega(x/t)$ will connect $u_l$ to $u_r$. For the case $u_l < u_r$, $\xi$ must be increasing, hence $\lambda_j( \omega(x/t)$ must be increasing. We call these solution curves, emanating from $u_l$, \textit{rarefaction waves} $u_r \in R_j(u_l)$
\begin{equation}
     u(x,t) = \begin{cases} u_l & \text{for $x < \lambda_j(u_l)t$,}\\
                            \omega(\frac{x}{t}) & \text{for $ \lambda_j(u_l)t$} < x <  \lambda_j(u_r)t,\\ 
                            u_r & \text{for $x >  \lambda_j(u_r)t$.} 
     \end{cases}
     \label{Eq:SystemRarefactionSol}
 \end{equation}
where $\omega(\xi)$ satisfies the assumptions (\ref{Eq:SystemsAssumptions}). Looking at $\dot \omega( \xi ) = r_j( \omega(\xi))$ along with the initial condition $\omega( \lambda_j( u_l) ) = u_l$ the integral curves in the $u$ plane is denoted $R_j(u_l)$.  Similarly, we can do this for $u_r$ and obtain the rarefaction curve emanating from $u_r$. For complete roof, and mathematical justification see Chapter $5$ in \cite{HoldenH.Helge2015Ftfh}. 

We investigate further the last assumption from (\ref{Eq:SystemsAssumptions}), $ \lambda_j (\omega(\xi)) = \xi$, and taking the derivative with respect to $\xi$ we obtain
\begin{align*}
    \frac{d}{d\xi} \xi &= \frac{d}{d\xi} \lambda_j( \omega (\xi)) \\
    1 &= \nabla \lambda_j (\omega(\xi)) \cdot \dot \omega (\xi) = \nabla \lambda_j \cdot r_j(\xi),
    \label{Eq:DirectionOfLambda}
\end{align*} 
which imposes an extra condition on the eigenvector fields. However, if we have constant velocities $\xi, \lambda_j$ this does not hold, as we are unable to normalise the eigenvector. We say the $j$th family 
\begin{align*}
    \nabla \lambda_j \cdot r_j = 1 \quad \text{is genuinely nonlinear, } \\
    \nabla \lambda_j \cdot r_j = 0 \quad \text{is linearly degenerate. }
\end{align*}

Lastly we introduce Riemann invariants, which are useful when solving the Riemann problem for systems. \begin{definition}[Riemann invariants]
A smooth function $\omega : \mathbb{R}^n \mapsto \mathbb{R}$ is called a \textit{k-Riemann invariant} if 
\begin{align*}
    \nabla \omega(u) \cdot r_k (u) = 0,
\end{align*}
where $r_k$ is the k'th right eigenvector of the strictly hyperbolic Jacobian.
\end{definition}
From the definition of Riemann invariants one can show that the rarefaction curves are constant on all Riemann invariants, and thus we can use this as an alternative definition of rarefaction curves. This will be useful when investigating our model for traffic in Section $3$.  

\paragraph{Contact Discontinuities.}
\begin{comment}
From (\ref{Eq:DirectionOfLambda}) recall $\lambda_j(u)$ is increasing along the rarefaction curve $R_j(u_l)$, we can take advantage of this direction and define a parameter $\epsilon := \xi - \xi_l = \lambda_j(u)-\lambda_j(u_l) > 0$. We denote the corresponding $u$ by $u_{j,\epsilon} = \omega(\lambda_j(u)) = \omega(\epsilon + \lambda_j(u_l))$. 
\end{comment}
Investigating the linearly degenerate case, we want to create a phase path of the eigenvector field. In this case, $\lambda$ is constant along the integral curve, and we have 
\begin{align*}
    \frac{d}{d\xi} f(u) = df(u) \dot u = df(u) \cdot r_j = \lambda_j \cdot r_j = \lambda_j \dot u \\
     \frac{d}{d\xi} \lambda = \nabla \lambda_j \cdot r_j = 0 \\
     \frac{d}{d\xi} f(u) =  \frac{d}{d\xi}( \lambda_j u ) \\
     f(u) = \lambda_j u. 
\end{align*}

The Rankine-Hugoniot relation is retrieved. We call this solution curve in the phase plane a contact discontinuity $C_j(u_l)$, passing through $u_l$. For each $u_r \in C_j(u_l)$ the initial value problem (\ref{Eq: RP}) has a solution \begin{equation}
    u(x,t) = \begin{cases}
    u_l \quad \text{for} \quad x < \lambda_j(u_l)t, \\
    u_r \quad \text{for} \quad x \geq \lambda_j(u_l)t. 
    \end{cases}
    \label{Eq:ContactDiscSol}
\end{equation} 
The rarefaction and the shock curves must necessarily be the same in this case. Also, the weak solution is satisfied. Again, for complete roof, and mathematical justification see Chapter $5$ in \cite{HoldenH.Helge2015Ftfh}. 

\paragraph{Shock waves. }
The obvious extension is to define the shock curves in the phase plane. Now assume $u_l$ is fixed, and we consider all possible states $u$ that satisfy the Rankine-Hugoniot relation. We call the trajectories in the phase plane the \textit{Hugoniot Locus}:
\begin{equation}
    \label{Hugoniot_locus}
    H(u_l) := \{ u : \exists s\in \mathbb{R} \quad \text{such that} \quad s[u] = [f] \}.
\end{equation}
However, the system $ \mathcal{H} := s[u] - [f] = 0 $ has $n$ equations, so we have $n+1$ unknowns in our case. Using the implicit function theorem we can prove that in a neighbourhood of $u_l$ we have $n$ unique differentiable solutions, only requiring that $d \mathcal{H}$ is non-singular (see Chapter $5$, theorem $5.11$ in \cite{HoldenH.Helge2015Ftfh}). 
 
\paragraph{The Lax entropy.} We have now found three types of solution curves which may arise when studying a strictly hyperbolic system of the form (\ref{GeneralEquation}). Emanating for a point $u_l$ we have at most $2n$ waves, $n$ rarefaction- and $n$ shock curves. We need to find a way to eliminate half of these possibilities to restore uniqueness. We do this by introducing Lax entropy. 
%In the systems case, $\dot U = f(U) - f(u_l) - s(U-u_l)$ will give the flow in the eigenvectorspace, and determines whether or not we can connect $u_l$ to $u_r$. 

In the case of systems, the eigenvalues in the critical point determines the behaviour of the eigenvector field. In our (real) case, we have the following possibilities, $\boldsymbol{\lambda} > 0 $ source, $\boldsymbol{\lambda} < 0 $ sink, $\lambda_i < 0 < \lambda_j $ saddle \cite{VerhulstFerdinand1990NDEa}.
It is clear that for there to exist an orbit from $u_l$ to $u_r$, $u_l$ cannot be a pure sink, and $u_r$ cannot be a pure source. This means we go from $9$ different combinations, down to $4$, and can be seen in the Figure \ref{fig:LaxMotivation}. 
\begin{figure}[H]
    \centering
    \begin{minipage}{.2\textwidth}
    \begin{tikzpicture}
    [decoration={markings, 
            mark= at position 0.8 with {\arrow[line width=0.4mm]{latex}} }
    ] 
    \draw[postaction = {decorate}] (1,0) -- (0,0); 
    \draw[postaction = {decorate}] (1,0) -- (2,0); 
    \draw[postaction = {decorate}] (1,0) -- (1,1);
    \draw[postaction = {decorate}] (1,0) -- (1,-1);
    \filldraw[black] (1,0) circle (1pt) ;
    \node at (2, 1,1) {$u_l$};
    \node at (1,-1.5) {(source, $\lambda > 0$)};
    \end{tikzpicture}
    \end{minipage}
    \begin{minipage}{.2\textwidth}
    \begin{tikzpicture}
    [decoration={markings, 
            mark= at position 0.55 with {\arrow[line width=0.4mm]{latex}} }
    ] 
    \draw[postaction = {decorate}] (0,0) -- (1,0); 
    \draw[postaction = {decorate}] (2,0) -- (1,0); 
    \draw[postaction = {decorate}] (1,1) -- (1,0);
    \draw[postaction = {decorate}] (1,-1) -- (1,0);
    \filldraw[black] (1,0) circle (1pt) ;
    \node at (2, 1,1) {$u_r$};
    \node at (1,-1.5) {(sink, $\lambda < 0$)};
    \end{tikzpicture}
    \end{minipage}
    \quad
    \begin{minipage}{.2\textwidth}
    \begin{tikzpicture}
    [decoration={markings, 
            mark= at position 0.8 with {\arrow[line width=0.4mm]{latex}} }
    ] 
    \draw[postaction = {decorate}] (1,0) -- (0,0); 
    \draw[postaction = {decorate}] (1,0) -- (2,0); 
    \draw[postaction = {decorate}] (1,0) -- (1,1);
    \draw[postaction = {decorate}] (1,0) -- (1,-1);
    \filldraw[black] (1,0) circle (1pt) ;
    \node at (2, 1,1) {$u_l$};
    \node at (1,-1.5) {(source, $\lambda > 0$)};
    \end{tikzpicture}
    \end{minipage}
    \begin{minipage}{.2\textwidth}
    \begin{tikzpicture}
    [decoration={markings, 
            mark= at position 0.65 with {\arrow[line width=0.4mm]{latex}} }
    ] 
    
    \draw[postaction = {decorate}] (1,0) -- (0,0); 
    \draw[postaction = {decorate}] (1,0) -- (2,0); 
    \draw[postaction = {decorate}] (1,1) -- (1,0);
    \draw[postaction = {decorate}] (1,-1) -- (1,0);
    \filldraw[black] (1,0) circle (1pt) ;
    \node at (2, 1,1) {$u_r$};
    \node at (1,-1.5) {(saddle, $\lambda < 0$)};
    \end{tikzpicture}
    \end{minipage}
    
    \begin{minipage}{.2\textwidth}
    \begin{tikzpicture}
    [decoration={markings, 
            mark= at position 0.65 with {\arrow[line width=0.4mm]{latex}} }
    ] 
    \draw[postaction = {decorate}] (1,0) -- (0,0); 
    \draw[postaction = {decorate}] (1,0) -- (2,0); 
    \draw[postaction = {decorate}] (1,1) -- (1,0);
    \draw[postaction = {decorate}] (1,-1) -- (1,0);
    \filldraw[black] (1,0) circle (1pt) ;
    \node at (2, 1,1) {$u_l$};
    \node at (1,-1.5) {(saddle, $\lambda > 0$)};
    \end{tikzpicture}
    \end{minipage}
    \begin{minipage}{.2\textwidth}
    \begin{tikzpicture}
    [decoration={markings, 
            mark= at position 0.65 with {\arrow[line width=0.4mm]{latex}} }
    ] 
    \draw[postaction = {decorate}] (0,0) -- (1,0); 
    \draw[postaction = {decorate}] (2,0) -- (1,0); 
    \draw[postaction = {decorate}] (1,0) -- (1,1);
    \draw[postaction = {decorate}] (1,0) -- (1,-1);
    \filldraw[black] (1,0) circle (1pt) ;
    \node at (2, 1,1) {$u_r$};
    \node at (1,-1.5) {(saddle, $\lambda < 0$)};
    \end{tikzpicture}
    \end{minipage}
    \quad
    \begin{minipage}{.2\textwidth}
    \begin{tikzpicture}
    [decoration={markings, 
            mark= at position 0.65 with {\arrow[line width=0.4mm]{latex}} }
    ] 
    \draw[postaction = {decorate}] (1,0) -- (0,0); 
    \draw[postaction = {decorate}] (1,0) -- (2,0); 
    \draw[postaction = {decorate}] (1,1) -- (1,0);
    \draw[postaction = {decorate}] (1,-1) -- (1,0);
    \filldraw[black] (1,0) circle (1pt) ;
    \node at (2, 1,1) {$u_l$};
    \node at (1,-1.5) {(saddle, $\lambda > 0$)};
    \end{tikzpicture}
    \end{minipage}
    \begin{minipage}{.2\textwidth}
    \begin{tikzpicture}
    [decoration={markings, 
            mark= at position 0.55 with {\arrow[line width=0.4mm]{latex}} }
    ] 
    \draw[postaction = {decorate}] (0,0) -- (1,0); 
    \draw[postaction = {decorate}] (2,0) -- (1,0); 
    \draw[postaction = {decorate}] (1,1) -- (1,0);
    \draw[postaction = {decorate}] (1,-1) -- (1,0);
    \filldraw[black] (1,0) circle (1pt) ;
    \node at (2, 1,1) {$u_r$};
    \node at (1,-1.5) {(sink, $\lambda < 0$)};
    \end{tikzpicture}
    \end{minipage}
    \caption{Admissible solutions of critical points.}
    \label{fig:LaxMotivation}
\end{figure}

In $n$ dimensions, we can have a combination of positive of negative eigenvalues.  When examining the possible flows in the eigenvector field, it is clear that at least one eigenvalue at $u_l$ needs to be larger than the one in $u_r$. for there to be an orbit connecting them. We summarise this argument into Lax' entropy condition
\begin{equation}
    \lambda_{j}(u_r) < s < \lambda_{j}(u_l), \quad \text{for orbits from $u_l$ to $u_r$}.
\end{equation}

\begin{definition}[Lax j-shock]
We say that a shock is a Lax j-shock if the speed satisfies the Rankine Hugoniot relation and 
\begin{align*}
    \lambda_{j-1}(u_l) < s < \lambda_{j}(u_l), \\
    \lambda_{j}(u_r) < s < \lambda_{j+1}(u_r).
\end{align*}
\end{definition}
For complete mathematical justification and proof see Chapter $5$ and Theorem $5.14$ in \cite{HoldenH.Helge2015Ftfh}. 
\begin{comment}
\subsubsection{The Kruzkov entropy}\label{The Kruzkov entropy}
Let $\eta = \eta(u)$ be a smooth convex function, and $\phi > 0$ our usual test function, $\phi \in C_0^\infty(\mathbb{R} \times (0, \infty))$ with compact support away from the x-axis. We will now investigate the case

\begin{align}
   0 &= \int_0^T \int_{\mathbb{R}} (u_t + f(u)_x - \epsilon u_{xx}) \eta' \phi dxdt \\
   &= \int_0^T \int_{\mathbb{R}} \underbrace{\eta'u_t}_{\eta_t}  \phi dx dt + \int_0^T \int_{\mathbb{R}} \underbrace{f'(u)\eta'}_{q'} u_x \phi dxdt - \epsilon \int_0^T \int_{\mathbb{R}} \underbrace{ u_{xx}\eta'}_{(\eta'u_x)_x - \eta''u_x^2}\phi dxdt \\
   &= \int_0^T \int_{\mathbb{R}}  \eta \phi_t dx dt + \int_0^T \int_{\mathbb{R}} q \phi_x dxdt  - \epsilon \int_0^T \int_{\mathbb{R}} \underbrace{ \eta'' (u_x)^2 \phi}_{ \geq 0} dxdt +  \epsilon \int_0^T \int_{\mathbb{R}} \eta \phi_{xx} dxdt \\
   & \leq \int_0^T \int_{\mathbb{R}} \bigg ( \eta \phi_t + q\phi_x + \epsilon \eta \phi_{xx} \bigg ) dx dt 
\end{align}    

\todo{fill in some details from the proof above}
Letting $\epsilon$ go to zero

\begin{equation}
    \int_0^T \int_{\mathbb{R}}( \eta \phi_t + q \phi_x)dxdt \geq 0
    \label{Kruzkov_distributions}
\end{equation}

We get the Kružkov entropy condition, in the sense of distributions. 

\begin{wrapfigure}[13]{L}{0.5\textwidth}
    \begin{center}
        \includegraphics[valign = c,clip, trim=2cm 18cm 2cm 2cm, width=0.4\textwidth]{Figures/ConservationLaws/convex.pdf}
    \caption{Convex function}
    \label{Fig:convex}
    \end{center}
\end{wrapfigure}{}
	  
Now, let us examine a generic convex function $\eta_\delta = \sqrt{(u-k)^2 + \delta^2}$, $\delta > 0 $.  Note that  $\lim_{\delta \to 0} = |u-k|$. And recall from above that we used $q' = \eta' f'(u)$, integrating we have

\begin{equation}
    q(u) = \int_k^u \eta' f'(v) dv = sgn(u-k)(f(u) - f(k))
\end{equation}

And we get the \textit{Kružkov entropy} condition

\begin{equation}
    \iint ( |u-k|\phi_t + sgn(u-k)( f(u) - f(k))\phi_x) dx dt \geq 0
    \label{Kruzkov}
\end{equation}

If $u$ satisfies this, its called a Kružkov entropy solution for all $k$ in $\mathbb{R}$.  If we let k be less than either $u_l$ or $u_r$ we retrieve Rankine-Hugoniot. And let $k$ be greater than $u_l$ or $u_r$ we also retrieve Rankine Hugoniot. Which implies that Kružkov is a weak solution. Also, note that we can easily extend this to include the initial condition. This would have given us an extra term $- \int_\mathbb{R} \eta \phi |_{t= 0}^{t = T} dx$

 We can approximate eta as a sum of piecewice convex linear functions. Such that any convex piecewise lin. function converges to eta in $L^{inf}$. This means that Kružkov holds for all convex functions. \todo{Add proof of convex functions}

We can show that Theorem \ref{RP_Kruzkov_sol} satisfies the Kruzkov entropy condition \ref{Kruzkov}. 
To complete the proof of \ref{RP_Kruzkov_sol}, we need to show that \ref{ScalarRiemannSol} indeed satistfies the Kruzkov entropy. 

The solution u consists of a finite number of discontinuities (shocks), seperated by wedges, and the continous parts are rarefaction waves. The solution of the Riemann problem consists of a finite sequence of rarefaction waves alternating with shocks.

\begin{equation}
    \begin{split}
        \int_0^T \int_{\mathbb{R}} \big ( \eta \phi_t + q\phi_x\big ) dx dt &=  \sum_i \int \int_{\Omega_i}(\eta_i\phi_t + q_i\phi_x)dxdt \\
        &=  \sum_i \int \int_{\Omega_i}(\eta_i\phi_t + q_i\phi_x + \underbrace{(\eta_t + q_x)}_{=0}\phi )dxdt \\ &= \sum_i\int \int_{\Omega_i}( (\eta_i \phi)_t + (q_i \phi)_x )dxdt 
    \end{split}
\end{equation}

\begin{wrapfigure}[14]{R}{0.5\textwidth}
    \begin{center}
        \includegraphics[valign = c,clip, trim=8cm 25.5cm 2cm 2.5cm, width=1.2\textwidth]{Figures/ConservationLaws/discrete_domain.pdf}
    \caption{Discrete domain}
    \label{Fig:discrete_domain}
    \end{center}
\end{wrapfigure}{}	 

Note that Theorem 2.2 does not require the flux function f to be differentiable. Assume now that the flux function is a polygon, i.e., that $f$ is continuous and piece- wise linear on a finite number of intervals. Thus $f'$ will then be a step function taking a finite number of values. This means that the envelopes also will be stepfunctions. If the initial states in a Riemann problem are breakpoints, then the entire solution will take values in the set of breakpoints.



\begin{equation}
\begin{split}
    \int_0^T \int_{\mathbb{R}} \big ( \eta \phi_t + q\phi_x\big ) dx dt &= \sum_i \int\int_{\partial \Omega_i}( -(\eta_i \phi)dt + (q_i \phi)dx )) \\
    &= \sum_i \int_{\partial \Omega_i} \phi(q_i,\eta_i) \cdot \Vec{n} ds \\
    &= \int_{\mathbb{R}} \eta \phi \bigg|_{t=0}^{t=T} dx + \sum_i \int_0^T \underbrace{\phi(\sigma_it,t)}_{\geq 0} \underbrace{\bigg( \sigma_i(\overline{\eta_i} - \underline{\eta_i}) -( \overline{q_i} -\underline{q_i}) \bigg )}_{\geq 0 \quad \text{Travelling Wave} }dt \\
    & \geq  \int_{\mathbb{R}} \eta \phi \bigg|_{t=0}^{t=T} dx
\end{split}
\end{equation}

Which concludes that the Riemann solution above indeed satisfies the Kruzkov entropy if $u_l < u_r$.

It can also be shown that Theorem \ref{RP_Kruzkov_sol} also holds for piecewise linear flux functions.
\end{comment}

\begin{comment}

\begin{definition}[Total Variation]
Let $J \subseteq \mathbb{R}$ and $w : J \to \mathbb{R}$. The total variation of $w$ is defined by
\begin{equation}
    TV(w) = \sup \bigg \{ \sum_{j=1}^{N} |w(x_j)-w(x_{j-1})| \bigg \} 
\end{equation}
\end{definition}

\begin{definition}
We say that the function $w : J \to \mathbb{R}$ has bounded total variation if $TV(w) < \infty $. We denote BV(J) the set of all real functions  $w : J \to \mathbb{R}$ with bounded total variation. 
\end{definition}
\end{comment}


%\begin{theorem}
%Let $u_0 \in L^1$ be a function of bounded total %variation, and $f(u)$ be a piecewise twice %continously differentiable function. Then there %exists a unique weak solution $u = u(x,t)$ to the %initial value problem
%\begin{equation*}
%    u_t + f(u)_x = 0, \quad u(x,0) = u_0(x)
%\end{equation*}
%which also satisfies the Kruzkov entropy condition %\ref{Kruzkov}. Furthermore, if $v_0$ is another %function in $BV \cap L^1(\mathbb{R}$, $g(v)$ is a %piecewise twice continously differentiable %function, and $v$ is the unique Kruzkov entropy %solution to 
%\begin{equation*}
%    v_t + g(v)_x = 0, \quad v(x,0) = v_0(x)
%\end{equation*}
%then
%\begin{equation}
%    ||u(\cdot,t) - v(\cdot, t)||_{L^1} + t \min %\{TV(u_0), TV(v_0)\}||f-g||_{Lip}
%\end{equation}

%\label{The_ultimate_result_scalar}
%\end{theorem}

%A proof of this result can be found in chapter 2.4 %in  \cite{HoldenH.Helge2015Ftfh}. 


\subsection{The solution of the Riemann problem}
We now summarise and generalise the previous results. The Riemann problem for $(u_l, u_r) \in \Omega$, \begin{align}
    u_t + f(u)_x = 0,\quad  u(0,x) = \begin{cases} 
    u_l  \quad x < 0, \\
    u_r \quad x \geq 0 .
    \end{cases}
    \label{Eq:RPFinal}
\end{align}
\begin{comment}
\subsubsection{Solution of the scalar convex equation}For $u, f(u) \in \mathbb{R}, f \in C^2$ and $f$ is strictly concave we have the following 
\paragraph{Shock solution.} If $u_l < u_r$, the entropy-admissible solution is given by the shock wave, as $f'(u_l) > f'(u_r) $. The shock speed given by the Rankine-Hugoniot condition
\begin{align}
    & u(x,t) = \begin{cases}
    u_l, \quad x < s t \\
    u_r, \quad x > s t
    \end{cases} 
    \quad \quad s = \frac{f(u_r) - f(u_l)}{u_r - u_l} 
    \label{Eq:SolRPScalarConvexShock}
\end{align}

\paragraph{Rarefaction solution.} If $u_l > u_r$, then $f'(u_l) < f'(u_r) $ so the entropy-admissible solution is given by a rarefaction wave.
\begin{align}
    & u(x,t) = \begin{cases}
    u_l, \quad x < f'(u_l)t \\
    (f')^{-1}(x/t),  \quad  f'(u_l)t < x < f'(u_r)t \\
     u_r, \quad x > f'(u_r)t
    \end{cases}
    \label{Eq:SolRPScalarConvexRaref}
\end{align}
We conclude this solution (\ref{Eq:SolRPScalarConvexShock}),(\ref{Eq:SolRPScalarConvexRaref}) of the equation (\ref{Eq:RPFinal}) if $f$ is strictly concave.
\end{comment}
\subsubsection{Solution of the scalar equation}
For $u, f(u) \in \mathbb{R}, f \in C^2$ where $f$ is a step-function, a continuous and piece-wise linear on a finite number of intervals. Then, also $f_{\smile}',f_{\frown}'$ will be step-functions, as will their inverses. Furthermore, assume $u_l = u_0 < u_1 < \dots < u_n = u_r$, and $f_\smile$ has breakpoints in some subsets of this. Thus we have discontinuities given by 
\begin{corollary}
Assume $f$ is a continuous piece-wise linear function $f: [-K, K] \rightarrow \mathbb{R}$ for some constant $K$. Denote the breakpoints of $f$ by $-K = u_0 < u_1 < \dots < u_{n-1} < u_n = K$. Then the Riemann problem 
\begin{equation*}
    u_t + f(u)_x = 0, \quad  u(x, 0) = \begin{cases} u_j \quad \text{for $ x < 0$,} \\ u_k, \quad \text{for $ x \geq 0$. } \end{cases}
\end{equation*}
has a piece-wise constant solution. 
If $u_j < u_k$, let $u_j = v_1 < \dots <v_m = u_k$ denote the breakpoints of $f_\smile$, and if $u_j > u_k$, let $u_k = v_m < \dots <v_1 = u_j$ denote the breakpoints of $f_\frown$. The weak solution of the Riemann problem is given by 
\begin{equation}
    u(x,t ) = \begin{cases}
    v_1 \quad \text{for $ x \leq s_1t$, } \\
    v_2 \quad \text{for $ s_1t \leq s_2 t$,} \\
    \vdots \\
    v_i \quad \text{for $ s_{i-1}t \leq s_i t $,} \\
    \vdots \\
    v_m \quad \text{for $ s_{m-1}t < x $,}
    \end{cases}\\
    \quad  s_i = \frac{f(v_{i+1}) - f(v_i) }{v_{i+1} - v_i},
    \label{Eq:SolRPScalarNonconvex}
\end{equation}
where the speeds $s_i$ are computed from the derivative of the envelope $f'_{\smile, \frown}$.
\end{corollary}

We conclude this solution (\ref{Eq:SolRPScalarNonconvex}) of the equation (\ref{Eq:RPFinal}) for scalar hyperbolic conservation laws. 

\subsubsection{Solution of systems of equations.} In the case of systems of conservation laws.
Assuming, without loss of generality, $u_l$ to be fixed. Then, show $u_l$ can be connected to $u_r$ using a series of rarefaction waves and shock waves. 
\begin{theorem}[Lax's theorem]
Assume that $f_j \in C^2(\mathbb{R}^n), j = 1, \dots,n. $ Let $\Omega$ be a domain in $\mathbb{R}^n$ and consider (\ref{Eq:RPFinal}) with $u \in \Omega$. Assume that each wave family is either genuinely nonlinear or linearly degenerate. Then, for $u_l \in \Omega$ there exists a neighbourhood $\tilde D \subset \Omega$ of $u_l$ such that for all $u_r \in \tilde D$ the Riemann problem (\ref{Eq:RPFinal}) has a unique solution in $\tilde D$ consisting of up to $n$ elementary waves, i.e., rarefaction waves, shock solutions satisfying the Lax entropy condition, or contact discontinuities. The solution is given by
\begin{align}
    u(x,t) = \begin{cases}
    u_l & \text{for $x < \sigma_1^- t$,} \\
    u_1(\frac{x}{t}; u_{m_1}, u_l) & \text{for $  \sigma_1^- t < x < \sigma_1^+ t$,} \\
    u_{m_1} & \text{for $ \sigma_1^+ t < x < \sigma_2^- t$,} \\
    u_2(\frac{x}{t}; u_{m_2}, u_{m_1}) & \text{for $ \sigma_2^- t < x < \sigma_2^+ t$,} \\
    u_{m_2} & \text{for $ \sigma_2^+ t < x < \sigma_3^- t$,} \\
    \vdots \\
    u_n(\frac{x}{t}; u_r, u_{m_{n-1}}) & \text{for $ \sigma_n^- t < x < \sigma_n^+ t$,} \\
    u_r & \text{for $x > \sigma_n^+ t$,} \\
    \end{cases}
    \label{Eq:SolRPSystems}
\end{align}
where we denote the speeds corresponding to the slowest and fastest waves of a family as
\begin{align*}
    \text{Rarefaction}
    \begin{cases}
    \sigma_j^- &=  \lambda_j(u_{m_{j-1}}), \\
    \sigma_j^+ &=  \lambda_j(u_{m_{j-1}}), 
    \end{cases}
    \quad\quad \parbox{4em}{Shock \\ Contact} \begin{cases}
    \sigma_j^- =  \sigma_j^+ = s_j, \\
    \sigma_j^- =  \sigma_j^+ = \lambda(u_{m_{j}}).
    \end{cases}
\end{align*}
\end{theorem}
For proof of Lax's theorem see Chapter $5$ in \cite{HoldenH.Helge2015Ftfh}.
We conclude this solution (\ref{Eq:SolRPSystems}) to equation (\ref{Eq:RPFinal}) for strictly hyperbolic systems of conservation laws. 

\newpage
\section{A Traffic Model with Phase Transitions}
%\subsection{Phase Transition Model}
A phase transition model for traffic flow was proposed by Colombo in $2002$ \cite{Colombo2003}. The model is a coupled scalar conservation law with a $2 \times 2$ system of conservation laws, where the assumption is that traffic consists of two different \textit{phases}, a free flow phase and a congested flow phase. The argument for this model is deep qualitative difference between the phases, and thus cannot be modelled solely by a single equation. The coupling is achieved via a free boundary, which means that the interface between the two states is dynamically controlled by the system. A typical free boundary model is the melting of ice into liquid, where the boundary is controlled by the heat equation. 

When modelling traffic we base our theory on \textit{the hypothesis of the fundamental diagram}, where we either assume that the fundamental diagram is a result of a traffic model, or we use the diagram explicitly in our model \cite[p.~254]{KernerHelbing}. We require the form of the fundamental diagram to be related to our observations. In our experience, the higher the density of cars, the lower the average speed should be. Kerner suggests in his work from $2002$ \cite{KernerHelbing} a fundamental diagram of the form seen in Figure \ref{fig:Kerner} (taken from  \cite[p. ~254]{KernerHelbing}). It presents experimental data that shows two distinct behaviours when the density reaches a specific $\rho_{max}^{(free)}$, also seen in Figure \ref{fig:Kerner}. The model Colombo presents, and we will investigate, gives a good explanation of the experimental results Kerner presents. Also, looking at the Figure \ref{fig:Kerner}, we typically want a positive slope for the free phase and a negative slope for the congested phase. In our model, we experience a capacity drop. Kerner defines this as a gap between the two curves \cite[p.~254]{KernerHelbing} when going from our free phase to the congested. The model we will investigate is in good agreement with Kerner's proposals. \begin{figure}[H]
    \centering
    \includegraphics[width=0.65\textwidth]{Figures/Model/Kerner.png}
    \caption{$a):$ A fundamental diagram satisfying needed properties. $b):$ Observations of real patterns in different countries \cite{KernerHelbing}. }
    \label{fig:Kerner}
\end{figure} Kerner also suggests dividing the congested phase into two different phases; wide-moving jams and synchronised flow \cite[p.~256]{KernerHelbing}. In this model, we will explain the underlying phases of congested flow based on the behaviour of the waves of the characteristic families. Thus, this traffic model is still in full agreement with Kerner's observations \cite{Colombo2003}.

Colombo suggests using the classical LWR model for the free phase. The argument for choosing LWR is that it gives a good solution to the \textit{traffic light problem} \cite[p.~71]{TrafficLight}. In this phase, the assumption is that the density $\rho$ is determined by the speed of the cars, $v(\rho)$. However, as the car density increases, the assumption that the speed is a function only on the density is no longer acceptable, and the density-flow points are scattered in a cloud rather than along a line. We denote this phase as the congested flow, see Figure \ref{fig:Kerner}b). 

Colombo proposes the following model for traffic flow: 
\begin{align}
    & \text{Free flow:}  (\rho, q) \in \Omega_f, \quad \quad \quad \text{Congested flow:} (\rho, q) \in \Omega_c, \nonumber \\
    & \rho_t + (\rho v )_x = 0, \quad \quad   \quad \quad \quad \quad 
    \begin{cases}
    \rho_t + (\rho v )_x = 0 , \\
    q_t + ((q-Q)v)_x = 0 ,
    \end{cases} \label{Eq:phase-transition} \\
    & v = v_f(\rho) = \big(1- \frac{\rho}{R}\big)V, \quad \quad \quad v = v_c(\rho,q) = \big(1 - \frac{\rho}{R}\big)\frac{q}{\rho}. \nonumber
\end{align}

Here we have the density $\rho$ and velocity $v$ as independent variables. The variable $q$ is the weighted flow, where the original motivation stems from gas dynamics, where it describes linear momentum \cite{Bressan}. The two phases have different speed laws, but the maximal car density $R$, the maximal speed $V$ and the wide jam parameter $Q$ \cite{GaravelloMauro2006Tfon}, are all global and constant for the model. The wide jam parameter allows us to satisfy criteria $4.$ below and will help us distinguish between the possible behaviours of the congested flow \cite{Colombo2003}. 

Note that the road is spatially and temporally translation invariant,  as none of the expressions depends explicitly on space or time. For this reason, the model is not able to predict when or where phase transitions may appear. However, we are able to predict under which circumstances a queue forms, given the left and right states \cite{Colombo2003}. Wave curve families are invariant under these transformations, in this case, a different scaling of $\rho$ and $q$. This is useful; instead of looking at a  large family of curves, we choose one representative sample of the family and understand this, and in principle, we have understood the whole system, as the rest of the curves are just scaled versions of the representative. As a consequence of translation invariance, Colombo suggests that if initial data is contained in a single phase, it will remain in the same phase for all times \cite{Colombo2003}. Furthermore, no evidence supports a spontaneous queue formation in free flow \cite{DAGANZO}, which justify this assumption.

First, we state four necessary criteria in order to make the traffic flow realistic, see \cite{Colombo2002}:
\begin{enumerate}
    \item The driver reacts to what is seen in front of the car, no information travels faster than cars.
    \item We cannot have a negative car density, and cars cannot travel backwards, $\rho, q \geq 0$. Furthermore, density and velocity should be bounded.
    \item We have a maximal car density $R$, so that whenever a queue is formed the maximal density is reached. 
    \item Below this maximal car density, no car may stop.
    %\item When moving at \textit{high} car densities and speeds accelerating produce rarefaction, and breaking produce shocks. At low car density and speeds, the opposite occurs. 
\end{enumerate} The criteria above will be investigated as we go through the solution of the Riemann problem for the model. However, one should note that not all of the criteria above may be realistic in all phases. 

We will first investigate the Riemann problem with initial data in the free phase before we continue with the Riemann problem for the congested phase. Lastly, we will combine the two and look at initial data in different phases.

\subsection{The Riemann Problem for Free Phase}\label{RPFreePh}
We start off by analysing the properties of the free phase, and at the end, we will give the full solution for the Riemann problem. We examine the flux function as a function of the density in a fundamental diagram, Figure \ref{Fig:Velocity function}, \ref{Fig:Flux function}. 
\begin{figure} \centering 
   \input{Figures/Model/FluxAndVelocityProp}
\end{figure}
Starting in $\rho = 0$, we are in the free phase. As soon as $\rho$ crosses a certain threshold $\rho_f$, we no longer regard $v$ as a function only of density, but also momentum. We call this threshold velocity $v(\rho_f) = V_f$, see Figure \ref{Fig:Velocity function}. So as $\rho$ increases in the free phase,  $v$ decreases, and reaches $V_f$. This means the maximal speed $V > V_f $, see Figure \ref{Fig:Velocity function}. Also, note that the flux function $f(\rho) = \rho v_f(\rho) $ is concave in the $(\rho , \rho v)$-plane, see Figure \ref{Fig:Flux function}, hence we are able to invert the flux function without using convex envelopes. We have the characteristic speed $df(\rho) = \frac{d}{d\rho}(\rho v(\rho)) = V(1- \frac{2\rho}{R}) > 0$ and its clear we have strictly hyperbolicity, and no information travels faster than cars, the maximum velocity $V$. We have achieved criteria $1.$ for realistic traffic flow, in this phase. This leads us to define the domain for the free phase \begin{equation}
    \Omega_f = \{(\rho, q) \in [0, \mathbb{R}] \times [0, \infty) : v_f(\rho) \geq V_f, q= \rho V \},
    \label{Domain free ph}
\end{equation} also, note that criteria $2.$ for realistic traffic flow is fulfilled, due to (\ref{Domain free ph}). 

The Riemann problem (\ref{Eq:RPFreePhase}) for the free phase, has the following solution for $(\rho_l, \rho_r) \in \Omega_f$
\begin{align}
    \rho_t + (\rho v)_x = 0,\quad  \rho(0,x) = \begin{cases} 
    \rho_l  & \text{for $x < 0$, }\\
    \rho_r  & \text{for $x \geq 0$.} 
    \end{cases}
    \label{Eq:RPFreePhase}
\end{align}

\paragraph{Rarefaction solution.} If $\rho_l > \rho_r$, then $f'(\rho_l) < f'(\rho_r) $ so the entropy-admissible solution is given by a rarefaction wave.
\begin{align}
    & \rho(x,t) = \begin{cases}
    \rho_l & \text{for $x < f'(\rho_l)t$, } \\
    (f')^{-1}(x/t)  &  \text{for $ f'(\rho_l)t \leq x \leq f'(\rho_r)t$,} \\
     \rho_r & \text{for $x > f'(\rho_l)t$, }
    \end{cases} \nonumber \\
    & f'(\rho) = V(1-\frac{2 \rho}{R}) , \quad  (f')^{-1}(\xi) = \frac{R}{2}(1-\frac{\xi}{V}).
    \label{Eq:CharacteristicSpeed}
\end{align}
An example of a rarefaction wave solution for the Riemann problem can be seen in Figure \ref{fig:ExampleRarefaction}. As in the case of the shock, we can see the initial condition in the plot to the left. After a given time, the rarefaction has smoothed out the sharp divide between the left and right state. A snapshot at $t = 0.2$ can be seen in the middle. Lastly, to the right we see the rarefaction fan for $t \in [0,1]$. This can also be thought of as viewed from above, and here we can see the rarefaction gradually smooths out $\rho$. The right plot of Figure \ref{fig:ExampleRarefaction} is in full agreement with what we expect a priori, see Figure \ref{Fig: SolRP_raref}.

\paragraph{Shock solution.} If $\rho_l < \rho_r$, the entropy-admissible solution is a shock wave, as $f \in C^2$ and $f$ is strictly concave and thus $f'(\rho_l) > f'(\rho_r) $. The shock speed $s$ given by the Rankine-Hugoniot condition
\begin{align*}
    & \rho(x,t) = \begin{cases}
    \rho_l & \text{for $x < st$, } \\
    \rho_r & \text{for $x \geq st$, }
    \end{cases} 
    \quad \quad s = \frac{f(\rho_r) - f(\rho_l)}{\rho_r - \rho_l} = \frac{\rho_r v_f(\rho_r) -\rho_l v_f(\rho_l)}{\rho_r - \rho_l}.
\end{align*}
If the shock speed is negative, we will have a wave propagating backwards. An example of a backward shock solution of the Riemann problem can be seen in Figure \ref{fig:ExampleBackwardsShock}. Note that if a queue is reached, then $\rho_r = R$. Inserting into the Rankine Hugoniot condition, we see that the shock speed is negative. Similarly, if the shock speed is positive, we will have a shock propagating forwards. An example of a forward shock solution of the Riemann problem can be seen in Figure \ref{fig:ExampleForwardShock}.
Consider the two example shock solutions; see Figures \ref{fig:ExampleBackwardsShock}, \ref{fig:ExampleForwardShock}. One can see that the initial values, plotted to the left, will determine whether the shock speed is positive or negative. A snapshot can be seen in the middle. The solution in the $(x,t)$-plane for both shocks can be seen to the right. Here we see that the shock moves either to the left or to the right, but this time it is viewed from "above". This solution is also in full agreement with what we expect a priori, see Figure \ref{Fig: SolRP_shock}. Note that in Figure \ref{Fig: SolRP_shock}, only the forward shock is drawn. 

We conclude this solution of the phase transition model if initial data $\rho_l, \rho_r \in \Omega_f$. In this phase, we can not reach zero velocity and thus not be able to form a queue. We can only move to higher density areas still in the free phase. Therefore, this phase can not satisfy criteria $3.$ and $4.$ alone.  

\begin{figure} \centering
    \input{Figures/Model/SolRPFreePhase}
\end{figure}

\begin{figure}
     \centering
     \begin{subfigure}[b]{0.3\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/Model/Plots/RarefacIV.png}
         %\caption{Initial value plot.}
         %\label{fig:RarefacIV}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.3\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/Model/Plots/RarefacAtTime.png}
         %\caption{Solution $\rho(x,t)$ at time $t = 0.2$}
         %\label{fig:RarefacAtTime}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.3\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/Model/Plots/RarefactionFull.png}
         %\caption{The solution $\rho$ in the $x,t$-plane. }
         %\label{fig:five over x}
     \end{subfigure}
        \caption{The evolution of a solution with initial values $\rho_l = 0.8, \rho_r = 0.2$, seen to the left. After $t = 0.2$, we have the middle figure. A full solution in the $x,t$-plane can be seen to the right.}
        \label{fig:ExampleRarefaction}
\end{figure}
\begin{figure}
     \centering
     \begin{subfigure}[b]{0.3\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/Model/Plots/BackwShockIV.png}
         %\caption{Initial value plot.}
         %\label{fig:RarefacIV}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.3\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/Model/Plots/BackwShockAtTime.png}
         %\caption{Solution $\rho(x,t)$ at time $t = 0.2$}
         %\label{fig:RarefacAtTime}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.3\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/Model/Plots/BackwShockFull.png}
         %\caption{The solution $\rho$ in the $x,t$-plane. }
         %\label{fig:five over x}
     \end{subfigure}
        \caption{The evolution of a solution with initial values $\rho_l = 0.2, \rho_r = 0.9$, seen to the left. After $t = 0.5$, we have the middle figure. A full solution in the $x,t$-plane can be seen to the right. $R = 1, V = 5, Q = 0.5$}
        \label{fig:ExampleBackwardsShock}
\end{figure}
\begin{figure}
     \centering
     \begin{subfigure}[b]{0.3\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/Model/Plots/ForwShockIV.png}
         %\caption{Initial value plot.}
         %\label{fig:RarefacIV}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.3\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/Model/Plots/ForwShockAtTime.png}
         %\caption{Solution $\rho(x,t)$ at time $t = 0.2$}
         %\label{fig:RarefacAtTime}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.3\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/Model/Plots/ForwShockFull.png}
         %\caption{The solution $\rho$ in the $x,t$-plane. }
         %\label{fig:five over x}
     \end{subfigure}
        \caption{The evolution of a solution with initial values $\rho_l = 0.3, \rho_r = 0.6$, seen to the left. After $t = 0.5$, we have the middle figure. A full solution in the $x,t$-plane can be seen to the right. $R = 1, V = 5, Q = 0.5$}
        \label{fig:ExampleForwardShock}
\end{figure}

\subsection{The Riemann Problem for the Congested phase}\label{RPCongPh}
When the density $\rho$ increases and velocity $v$ reaches the constant threshold $v(\check R) = V_c$, see Figure \ref{Fig:Velocity function}, the traffic enters the congested phase. As $\rho$ continues to increase, we will eventually reach maximal car density $R$. Now we have the relation $ V > V_f > V_c $, and we define the domain for the congested phase as follows \begin{equation}
    \Omega_c = \Bigg\{(\rho, q) \in [0, \mathbb{R}] \times [0, \infty) : v_c(\rho, q) \leq V_c, \frac{q-Q}{\rho} \in \Bigg[\frac{Q_1 - Q}{R}, \frac{Q_2 - Q}{R} \Bigg]  \Bigg\},
    \label{Domain congested ph}
\end{equation} again note that with this definition criteria $2.$ and $3.$ are fulfilled for the congested phase. 
\begin{wrapfigure}[12]{l}{0.3\textwidth}
    \input{Figures/Model/DomainOmegac}
\end{wrapfigure}{}
Where $Q_1$ and $Q_2$ determines the width of the domain $\Omega_{c}$, or the "cloud" in the congested phase \cite{Colombo2003}.  For now, the definition of the domain $\Omega_c$ seems taken out of thin air. However, as we will see later, the boundary of the domain corresponds to the upper and lower possible wave curve. This means that we only permit initial values within and on the boundary of the domain, and as a result, the solution will remain within the domain, including the middle state. If we do not put restrictions on $q, \rho$, we will get problems with zero or negative momentum for some densities. In the $(\rho , \rho v)$-plane, we would also see this happening with the lower wave curve dropping below zero for $\rho v$. This would mean either negative velocity or density, and neither make sense in our application. We will get back to the curves in the $(\rho , \rho v)$-plane after we have found the wave curves.

Physically, we can justify this property of the domain. If we look at the area below the lower wave curve, this area corresponds, at least for low densities, driving at speeds well below the speed limit. Drivers rarely do this, as the goal is often to get from $a$ to $b$ quickly. The same argument holds for the area above the upper wave curve. Here, the drivers are above the speed limit.  Furthermore, note $V_f > V_c$, as if $V_f = V_c$ the Riemann problem for the full model is not well-posed. We will return to this issue in the solution of the full model. Let $ u = (\rho, q)$, and we write the equations on system form
\begin{align*}
    \underbrace{\begin{pmatrix} \rho \\ q \end{pmatrix}_t}_{u_t} +  \underbrace{\begin{pmatrix} \rho v  \\ (q - Q) v \end{pmatrix}_x}_{f(u)_x} = 0, 
\end{align*}
where $v = v_c(\rho,  q) = (1 - \frac{\rho}{R}) \frac{q}{\rho}$. The system has the following Jacobian:
\begin{equation*}
    df(u) =\begin{pmatrix} -\frac{q}{R} & (1- \frac{\rho}{R}) \\ 
                            \frac{q(Q-q)}{\rho ^2} & \quad (2q -Q)(\frac{1}{\rho} - \frac{1}{R}) \end{pmatrix}.
\end{equation*}
We find the eigenvalues $\lambda_i$ and the eigenvectors $r_i$ of the Jacobian $df(u)$ by first computing $ det| df(u) - \lambda I| $ for the eigenvalues (\ref{Eq:EigenvaluesCongestedPhase}), and then solving $(df(u) - \lambda_i I) r_i  = 0$ by Gauss-Jordan elimination in order to find the eigenvectors $r_i$ (\ref{Eq:EigenvectorsCongPh}). The derivation is as follows 
\begin{align*}
   det| df(u) - \lambda I | &= \left|\begin{matrix}
\frac{-q}{R}-\lambda & \frac{R-\rho}{R}, \\
\frac{-q^2+Qq}{\rho^2} & \frac{-QR+2Rq+Q\rho-2q\rho}{R\rho}-\lambda
\end{matrix}\right|, \\
&= (\frac{-q}{R}-\lambda)( \frac{-QR+2RqQ\rho-2q\rho}{R\rho}-\lambda) - (\frac{R-\rho}{R})(\frac{-q^2+Qq}{\rho^2}) = 0, \\
 \lambda_1 &= \frac{-QR + Rq + Q\rho -2q\rho}{R\rho}, \quad \quad  \lambda_2 = \frac{Rq - q\rho}{R\rho} .
\end{align*}
Inserting for $\lambda_1$ in the matrix above and performing Gauss-Jordan elimination yields 
\begin{align*}
   & \left(\begin{array}{cc|c}
\frac{QR-Rq-Q\rho+q\rho}{R\rho} & \frac{R-\rho}{R} & 0 \\
\frac{-q^2+Qq}{\rho^2} & \frac{q}{\rho} & 0
\end{array}\right) \sim  \left(\begin{array}{cc|c}
1 & \frac{\rho}{Q-q} & 0 \\
0 & 0 & 0
\end{array}\right).
\end{align*}
Similarly for $\lambda_2$
\begin{align*}
    \left(\begin{array}{cc|c}
\frac{-q}{\rho} & \frac{R-\rho}{R} & 0\\
\frac{-q^2+Qq}{\rho^2} & \frac{-QR+Rq+Q\rho-q\rho}{R\rho} & 0
\end{array}\right) \sim \left(\begin{array}{cc|c}
1 & \frac{\rho^2-R\rho}{Rq} & 0 \\
0 & 0 & 0
\end{array}\right).
\end{align*}
We rewrite and summarise the result below
\begin{align}
    &\lambda_1 = \big ( \frac{2}{R} - \frac{1}{\rho} )\big (Q- q) - \frac{Q}{R} , \quad \quad \lambda_2 = \big(1 - \frac{\rho}{q}\big)\frac{q}{\rho} = v_c , \label{Eq:EigenvaluesCongestedPhase} \\
    & r_1 = \begin{pmatrix} \rho \\ q - Q \end{pmatrix}, \quad \quad \quad  \quad \quad \quad \quad \quad  r_2 = \begin{pmatrix} R - \rho \\ \frac{Rq}{\rho} \end{pmatrix} , \label{Eq:EigenvectorsCongPh} \\
    & \nabla \lambda_1 \cdot r_1 = 2\frac{Q-q}{R}, \quad \quad \quad \quad \quad  \quad \nabla \lambda_2 \cdot r_2 = 0 . \label{Eq:GNLorLDcongPh}
\end{align}
Where the last line (\ref{Eq:GNLorLDcongPh}) can be shown by simply taking the gradient of the eigenvalue with respect the the variables $(\rho,q)$ and then the dot product with the corresponding eigenvector $r$.
\begin{align*}
    & \quad \quad \quad \quad  \nabla \lambda_i \cdot r_i = \big( \frac{d\lambda_i}{d\rho}, \frac{d\lambda_i}{dq}\big) \cdot r_i, \\
    & \text{i = 1:} \quad \big(- \frac{q-Q}{\rho^2}, \frac{R-2\rho}{R\rho} \big) \cdot \begin{pmatrix} \rho \\ q - Q \end{pmatrix} = 2 \frac{Q-q}{R}, \\
    & \text{i = 2:} \quad \big(- \frac{q}{\rho^2}, \frac{1-\rho/r}{\rho}\big) \cdot \begin{pmatrix} R - \rho \\ \frac{Rq}{\rho} \end{pmatrix} = 0 .
\end{align*}
When investigating (\ref{Eq:GNLorLDcongPh}) we see that if $q \neq Q$ we have one genuinely non-linear first family and one linearly degenerate second family. However, if $ Q = q$, we have a linearly degenerate field also for the first wave. So the first wave is both genuinely non-linear and linearly degenerate. However, this does not cause problems as we will see later.

We continue by investigating if or when this system is strictly hyperbolic
\begin{align*}
    \lambda_2 - \lambda_1 &= \big(1 - \frac{\rho}{q}\big)\frac{q}{\rho} - \bigg(\big ( \frac{2}{R} - \frac{1}{\rho} )\big (Q- q) - \frac{Q}{R} \bigg) = \frac{q}{\rho} - \frac{q}{R}- \bigg( \frac{Q}{R} - \frac{2q}{R} - \frac{Q}{\rho} + \frac{q}{\rho}\bigg) , \\
                        &= \frac{q- Q }{R} + \frac{Q}{\rho} > 0 \quad \text{if $\rho \in (0,R)$, $q \geq 0$} .
\end{align*}
We see we have a strictly hyperbolic system with $\lambda_1 < \lambda_2 = v_c$ as long as $\rho,q \geq 0, R, Q > 0$, and we have achieved both criteria $1. $ and $2.$ for realistic traffic flow.  Also in this phase, no information travels faster than the cars. 

\paragraph{Rarefaction curves and contact discontinuities.}
We continue by finding the wave curves for the genuinely non-linear case of the first family; we denote this rarefaction curve $q_1$. For the linearly degenerate second family, we find a contact discontinuity; we denote it $q_2$. We assume $u_l$ is fixed and integrate the eigenvectors from $u_l$ to $u$ in the phase-plane. As we do the same procedure for both families, we place the derivation side by side.  
\begin{alignat*}{2}
    & \text{Rarefaction:}  && \text{Contact Discontinuity:} \\
    r_1 &= \begin{pmatrix} \rho \\ q - Q \end{pmatrix}, \quad\quad \quad\quad\quad \quad\quad\quad   r_2 &&= \begin{pmatrix} R - \rho \\ \frac{Rq}{\rho} \end{pmatrix}, \\ 
    \frac{dq}{d\rho} &= \frac{q-Q}{\rho}, \quad\quad \quad\quad\quad\quad\quad\quad\quad  \frac{dq}{d\rho} &&= \frac{Rq}{\rho(R-\rho)},  \\
    \int_{q_l}^{q} \frac{1}{q-Q} dq &= \int_{\rho_l}^{\rho} \frac{1}{\rho} d\rho, \quad\quad\quad \quad\quad\quad \int_{q_l}^{q} \frac{1}{q} dq &&= \int_{\rho_l}^{\rho} \frac{R}{\rho(R - \rho)} d\rho, \\
    \frac{q-Q}{q_l -Q} &= \frac{\rho}{\rho_l}, \quad \quad\quad\quad\quad\quad\quad\quad\quad\quad\quad  \frac{q}{q_l} &&= \frac{\rho( R- \rho_l)}{\rho_l(R-\rho)},
\end{alignat*}
This leads to the following wave curves
\begin{align}
    & q_1 = \frac{q_l - Q}{\rho_l} \rho + Q, \quad \quad \textit{Rarefaction curve,}
    \label{Eq:RarefactionWCongestedPh} \\
    &  q_2 = \frac{q_l}{\rho_l} \frac{R - \rho_l}{R- \rho} \rho,   \quad \quad \textit{Contact Discontinuity.}
    \label{Eq:ContactDiscCongestedPh}
\end{align}

While we are investigating the rarefaction curve, we will find the expression in the $(x,t)$-plane. Recall from Chapter $2$, the assumptions on the system (\ref{Eq:SystemsAssumptions}). In our case, as we only have one rarefaction, we have 
\begin{align}
    & \dot \omega(\xi) = r_1( \omega(\xi)),  \quad \quad \quad \omega(\lambda_1(u_l)) = u_l, \nonumber \\
    &\begin{pmatrix} \dot \rho(\xi) \\ \dot q(\xi) \end{pmatrix} = - \frac{R}{2-Q}\begin{pmatrix}  \rho \\ q - Q\end{pmatrix}, \nonumber\\
    & \frac{d\rho}{d\xi} = - \frac{R \rho}{2(q-Q)}, \quad \quad  \quad \quad  \frac{dq}{d\xi} = -\frac{R}{2}, \label{Eq:drho_dq_dXi}
\end{align}
where we have used the normalised eigenvector. A quick look at the expression for $dq/d\xi$ in (\ref{Eq:drho_dq_dXi}) we see that this is the easiest to start with. Integrating, and inserting the initial condition we get the expression
\begin{align*}
    q(\xi) &= -\frac{R}{2}\xi + C, \\
    q(\lambda_1(u_l)) &= -\frac{R}{2}((\frac{2}{R}- \frac{1}{\rho_l})(Q-q_l) -  \frac{Q}{R}) + C = q_l, \\
    C &= \frac{R}{2\rho_l}(q_l - Q) + Q/2, 
\end{align*}
\begin{equation}
    q(\xi) = \frac{R}{2}( \frac{1}{\rho_l}(q_l - Q) - \xi ) + Q/2 . \label{Eq:q(xi)}
\end{equation}
Now we have an expression for $q(\xi)$ we continue with $\rho$, and insert $q(\xi)$ for $q$ in (\ref{Eq:drho_dq_dXi})
\begin{align*}
    \frac{d\rho}{R \rho} &= -\frac{d \xi}{2( \frac{R}{2}( \frac{1}{\rho_l}(q_l - Q) - \xi ) + Q/2 -Q) } = -\frac{d \xi}{R \big( \frac{(q_l - Q) }{\rho_l}- \xi \big) -Q) } ,\\
                \rho(\xi) &= K \big( R (\rho_l \xi - q_l +Q) + \rho_l Q \big) \\
    \rho(\lambda_1(u_l)) &= K( R \rho_l ((\frac{2}{R}- \frac{1}{\rho_l})(Q-q_l) -  \frac{Q}{R}) - q_l +Q) + \rho_l Q) = \rho_l \\
    \rho_l &= K( 2 \rho_l (Q-q_l )) \\
    K &= \frac{1}{2(Q-q_l)}
\end{align*}
\begin{equation}
    \rho(\xi) = \frac{R(\rho_l \xi - q_l + Q) + Q \rho_l}{2(Q-q_l)} \label{Eq:rho(xi)}
\end{equation}
These equations, $\rho(\xi), q(\xi)$, will be used later when solving the system and plotting the solutions as we did in the scalar case. 

\paragraph{Shock curves.}
Lastly, using the Rankine-Hugoniot condition (\ref{Hugoniot_locus}), and solving for $q$ by eliminating $s$
\begin{align*}
     s \begin{pmatrix} \rho_l - \rho \\ q_l - q \end{pmatrix} &= \begin{pmatrix} \rho_l v_l - \rho v \\ (q_l - Q)v_l - (q - Q)v \end{pmatrix}, \nonumber\\
     \frac{\rho v - \rho_l v_l}{\rho - \rho_l} &= \frac{(q-Q)v - (q_l-Q)v_l}{q - q_l}, \nonumber
\end{align*}
Then we insert for $v = v_c = (1- \frac{\rho}{R})\frac{q}{\rho}$, and after a much manipulation we find
\begin{align}
      q &= \frac{q_l - Q}{\rho_l} \rho + Q,  \quad \quad \textit{Shock curve.}
     \label{Eq:ShockCongPh}
\end{align}
The rarefaction curve (\ref{Eq:RarefactionWCongestedPh}) and shock curve (\ref{Eq:ShockCongPh}) coincide for the first family, and together with the contact discontinuity (\ref{Eq:ContactDiscCongestedPh}), we only have two solution curves in the phase-plane for the congested phase. In the $(\rho,q)$-plane, the $1$-family are straight lines, while the $2$-family is convex.
We still do not know the direction of the first family, and we still have both a shock and a rarefaction solution on the first wave family; hence we continue with Lax entropy. 

\paragraph{Lax entropy.}
%\begin{align*}
%    & q > Q \implies \nabla \lambda_1 \cdot r_1 < 0 \\
%    & q < Q \implies \nabla \lambda_1 \cdot r_1 > 0
%\end{align*}
We wish to find how $\lambda$ changes on the first wave, as increasing $\lambda$ is a requirement for Lax entropy. The first wave can be rewritten as 
\begin{align*}
q &=  \frac{\rho( q_l - Q)}{\rho_l} + Q \\
 & \frac{\rho( q - Q)}{\rho}  =  \frac{\rho( q_l - Q)}{\rho_l}.
\end{align*}
Inserting this expression for the first wave into the expression for $\lambda_1$, we have
\begin{align}
     \lambda_1 &= \big ( \frac{2}{R} - \frac{1}{\rho} )\big (Q- q) - \frac{Q}{R} 
     = \frac{Q - 2q}{R} + \frac{q-Q}{\rho}, \nonumber \\
     \lambda_1 &= \frac{Q - 2q}{R} + \frac{q_l-Q}{\rho_l}.
     \label{Eq:DirectionOfLambda}
\end{align}

Using the Lax entropy condition for the shock wave, along with the found direction of increasing $\lambda$ we have \begin{align}
   &  \lambda_1 (u_r) < s < \lambda_1 (u_l).
   \label{Eq:LaxEntropyCongPh}
\end{align} We need an increase in $\lambda_1 $ from $u_r$ to $u_l$ for a Lax 1-shock.

\begin{figure}
    \centering
    \input{Figures/Model/LaxEntropy}
\end{figure}

Due to the direction of $\lambda_1$ in combination with (\ref{Eq:LaxEntropyCongPh}) we get a shock when moving backwards from $u_l$. That means, when $q > Q$, $\rho_l < \rho_r$ produce a shock, and $\rho_l > \rho_r$ produce a rarefaction, see Figure \ref{Fig:LaxEntropy1CongestedPhase}. Below the critical line $q < Q$, see Figure \ref{Fig:LaxEntropy2CongestedPhase}, by applying the same argument, we also get a shock moving backwards from $u_l$. That means, when $q < Q$ , $\rho_l < \rho_r$ produce a rarefaction, and $\rho_l > \rho_r$ produce a shock. The regions for shock and rarefaction on the first family wave curves are depicted in both figures, as well as the direction of increasing $\lambda_1$. 
\begin{comment}
 Colombo summarised this result nicely in \cite{Colombo2002}.
\begin{equation}
\begin{aligned}
   & \begin{cases}
    \nabla \lambda_1 \cdot r_1 < 0 , \\
    q > Q ,
    \end{cases} \iff \begin{cases}
    \text{Braking} \leftrightarrow \text{Shock,} \\
    \text{Accelerating} \leftrightarrow \text{Rarefaction,} 
    \end{cases}  \\
   &\begin{cases}
    \nabla \lambda_1 \cdot r_1 > 0 , \\
    q < Q ,
    \end{cases} \iff \begin{cases}
    \text{Braking} \leftrightarrow \text{Rarefaction,} \\
    \text{Accelerating} \leftrightarrow \text{Shock,} 
    \end{cases}
    \label{LaxentropySummarised}
\end{aligned} \end{equation} From the result above (\ref{LaxentropySummarised}), we have now acquired criteria $5.$ for realistic traffic flow, and it is allowed by the $(q-Q)v$-term in the model equation for congested traffic. \end{comment}
%From an experimental point of view we can now estimate the parameters $Q_1, Q_2$, and $Q$. 
%We can also reformulate the solution curves in the $(\rho, \rho v)$-plane, for both the congested phase and free phase. 

As promised earlier in this subsection, we investigate the wave curves in the $(\rho, \rho v)$-plane. First, we rewrite $v_c(\rho,q)$, and then we insert for $q$ in the wave equations
\begin{alignat*}{2}
    v_c(\rho,q) &= ( 1 - \frac{\rho}{R})\frac{q}{\rho},  \quad \quad v_f(\rho) &&= (1- \frac{\rho}{R}V),  \\
    q &= \frac{\rho v }{( 1 - \frac{\rho}{R})}, \quad \quad \quad\quad \rho v &&= \rho(1- \frac{\rho}{R})V .
\end{alignat*}

Now, for the $1$-family wave curve
\begin{align*}
    q &= \frac{q_l-Q}{\rho_l}\rho + Q, \\
    \frac{\rho v}{1- \frac{\rho}{R}} &= \frac{\rho}{\rho_l}( \frac{\rho_l v_l}{1- \frac{\rho_l}{R} } -Q )  + Q , \\
    \rho v &= (1 - \frac{\rho}{R}) \bigg( \frac{\rho}{\rho_l}( \frac{\rho_l v_l}{1- \frac{\rho_l}{R}} - Q) + Q \bigg). 
\end{align*}
Lastly, for the $2$-contact
\begin{align*}
    q &= \frac{\rho}{\rho_l} \frac{R - \rho_l}{R - \rho} q_l, \\ 
    \rho v &= \frac{\rho (1 - \frac{\rho}{R}) }{\rho_l} \frac{R - \rho_l}{R - \rho} \frac{\rho_l v_l}{1 - \frac{\rho_l}{R}}  = \rho v_l . \\ 
\end{align*}
In Figure \ref{fig:RhoVFigure} we see the now linear contacts as orange, and the blue curves are shock and rarefaction curves. The pink curve is the free phase domain. 
In the $(\rho , \rho v)$-plane, see Figure \ref{fig:RhoVFigure}, we can see we have achieved criteria $3$ and $4.$ for realistic traffic. At the maximal car density $R$, the velocity is zero. At his point, we have a traffic jam, where the vehicles have fully stopped. Note that this is the only density where the velocity is zero, except for $ \rho = 0$. Below this maximal car density, no vehicle has zero velocity and thus no car may stop.  
Comparing our model in the $(\rho, \rho v)$-plane, Figure \ref{fig:RhoVFigure}, to the experimental data we presented at the start of this chapter, see Figure \ref{fig:Kerner}, we see we have a similar shape and description as Kerner proposes. Here, we can clearly see the positive slope in the free phase, and the negative slope in the congested. We also have a gap between our two phases, which corresponds to Kerner's capacity drop. We only allow for initial values within and on the boundary of our domain, and thus we see initial values within the grey area in he figure, which corresponds well to Figure \ref{fig:Kerner}. 
\begin{comment}
Lastly, inserting for $q$ in our found direction of $\lambda_1$
\begin{align*}
    \lambda_1 = \frac{Q-2q}{R} + \frac{q_l-Q}{\rho_l} = -\frac{2\rho v}{R(R-\rho)}+ Q( \frac{1}{R} - \frac{1}{\rho_l}) + \frac{v_l}{R- \rho_l}
\end{align*}
we see that we have increasing $\lambda_1$ when $\rho v$ is decreasing.  
\end{comment}
\begin{figure}
    \centering
    \include{Figures/Model/RhoVFigure}
    \caption{The domain $\Omega_c$ and $\Omega_f$ in the $(\rho v , \rho)$- plane.}
    \label{fig:RhoVFigure}
\end{figure}


\paragraph{The Riemann Problem.}
We have now all the necessary components to solve the Riemann Problem in the congested phase. Assume $(u_l, u_r) \in \Omega_c, u = (\rho, q)$, we have the following Riemann problem: 
\begin{align}
     \begin{cases} \rho_t + (\rho v)_x = 0 \\
     q_t + ((q-Q)v)_x = 0 ,
    \end{cases} \quad \quad (\rho, q) (0,x) = \begin{cases}
    (\rho_l, q_l) & \text{for $x < 0$,} \\
    (\rho_r, q_r) &  \text{for $x \geq 0$,}
    \end{cases}
    \label{Eq:RPCongestedPhase}
\end{align}

We have two wave curve families. The first and slow family $W_1(u_l)$, 
\begin{align*}
     W_1(u_l) = \frac{\rho( q_l - Q)}{\rho_l} + Q  \begin{cases}
          q_l > Q:  \text{Rarefaction when $\rho_l > \rho_r$, shock when $\rho_l < \rho_r$,}\\
          q_l < Q: \text{Rarefaction when $\rho_l < \rho_r$ shock when $\rho_l > \rho_r$,} \\
          q_l = Q:  \text{Contact discontinuity for all $\rho_l, \rho_r$. } \
     \end{cases}
\end{align*}
And the second fast family 
\begin{align*}
     W_2(u_l) = \frac{\rho( R - \rho_l)}{\rho_l( R - \rho)}, \quad \text{Contact discontinuity for all $u$.}
\end{align*}

We always have to move in the direction of increasing $\lambda$. Thus, we travel from the left state on the slow wave to an intermediate state, followed by a fast wave to the right state. If $u_l, u_r \in W_1(u_l)$ then the solution is only a slow first wave $W_1(u_l)$ to $u_r$. This is true for shock, rarefaction and contact discontinuity if $u_l(\rho, q_l = Q)$. This also holds for $u_l, u_r \in W_2(u_l)$, then the solution is only a fast second family wave from $u_l$ to $u_r$, a contact discontinuity. 

We have proved Proposition $2.1$ in \cite{Colombo2002}. We state the result below.

\begin{proposition}
Fix positive $Q, R, V$, and let $\rho > 0$ . For all $(\rho_l, q_l)$ and $(\rho_r, q_r)$ in $\Omega_c$, the Riemann problem (\ref{Eq:RPCongestedPhase}) with \begin{align*}
    v = v_c(\rho,q) = \big(1 - \frac{\rho}{R}\big)\frac{q}{\rho},
\end{align*} admits a unique self-similar solution consisting of a slow wave $W_1(u_l)$ between  $(\rho_l, q_l)$ and  $(\rho_m, q_m)$, followed by a fast contact discontinuity  $W_2(u_m)$ between  $(\rho_m, q_m)$ and  $(\rho_r, q_r)$. The slow wave is present whenever $v_c(\rho_l, q_l) \neq v_c(\rho_r, q_r)$ and is either a shock, rarefaction or a contact discontinuity. The latter case if and only if $q_l = Q$. In all cases, the solution attains values in $\Omega_c$.
\end{proposition}
Note we require $\rho > 0$ for well-posedness, as the contact discontinuity is undefined for $\rho = 0$. However, this will not be a problem when investigating the full model, as a phase transition into a free phase will occur when we approach low density. 

\begin{figure} \centering
    \input{Figures/Model/SolRPCongInXT}
\end{figure}

We demonstrate possible solutions of (\ref{Eq:RPCongestedPhase}). The combinations of waves in the $(x,t)$-plane can be seen in Figures \ref{Fig:SolRPRarefDiscCongestedPhase}, \ref{Fig:SolRPShockDiskCongestedPhase} and \ref{Fig:SolRPDiscCongestedPhase}. The order of the first and second family waves are consistent with previous results. Figure \ref{fig:SolRPCongInRhoQ} shows four possible solutions in $\Omega_c$. The corresponding written solutions are (\ref{Eq:correspondingSolu1u2}), (\ref{Eq:correspondingSolu3u4}). 
\begin{figure}
    \centering
    \input{Figures/Model/SolRPCongInRhoQ}
    \caption{Solutions of the congested phase in the $(\rho,q)$-plane. All solution curves emanating from the points $u_l, u_r$ are drawn, but only the coloured are admissible solutions. Rarefactions (blue), shocks (green) and contacts (orange). }
    \label{fig:SolRPCongInRhoQ}
\end{figure}
\begin{align}
    u_1(x,t) =  u_2(x,t) = \begin{cases} 
    u_l & \text{for  $x < \lambda_1(u_l)t$},\\
    %W_1, \lambda_1(u_l)t < x < \lambda_1(u_r)t, \quad \textit{Shock}\\ 
    u_m & \text{for $\lambda_1(u_r)t < x < \lambda_2(u_l)t$}, \\
    %W_2, \lambda_2(u_l)t < x < \lambda_2(u_r)t \quad \textit{Contact D.} \\
    u_r & \text{for $ x > \lambda_2(u_r)t$}, \\
    \end{cases}
    \label{Eq:correspondingSolu1u2}
\end{align}
\begin{align}
    u_3(x,t) = u_4(x,t) =\begin{cases}
    u_l  &\text{ for $x < \lambda_1(u_l)t$},\\
    w_1 &\text{ for $ \lambda_1(u_l)t < x < \lambda_1(u_r)t$},\\ 
    u_m &\text{for  $\lambda_1(u_r)t < x < \lambda_2(u_l)t$}, \\
   % W_2, \lambda_2(u_l)t < x < \lambda_2(u_r)t \quad \textit{Contact D.} \\
    u_r &\text{for  $x > \lambda_2(u_r)t$}, \\
    \end{cases} 
    \label{Eq:correspondingSolu3u4}
\end{align}
\begin{align}
    u_5(x,t) = \begin{cases}
    u_l & \text{for $x < \lambda_1(u_l)t$},\\
    %W_1, \lambda_1(u_l)t < x < \lambda_1(u_r)t, \quad \textit{Contact D.}\\ 
    u_m & \text{for $\lambda_1(u_r)t < x < \lambda_2(u_l)t$}, \\
    %W_2, \lambda_2(u_l)t < x < \lambda_2(u_r)t \quad \textit{Contact D.} \\
    u_r & \text{for $x> \lambda_2(u_r)t$,} \\
    \end{cases}
    \label{Eq:u_5}
\end{align}
\begin{align*}
   & w_1(\xi = \frac{x}{t} ; u_l, u_m) = \begin{pmatrix} \rho(\frac{x}{t})  \\ q(\frac{x}{t}) ) \end{pmatrix} 
\end{align*}
where $\rho(x/t) = \rho(\xi)$ we found earlier, see (\ref{Eq:rho(xi)}), and $q(x/t) = q(\xi)$ see (\ref{Eq:q(xi)}). 

%\begin{wrapfigure}[12]{r}{0.29\textwidth}
%   \input{Figures/Model/SolRPCongU5}
%   \caption{$q_l = Q$. We have a 1-contact (red) followed by a 2-contact (orange).}
%    \label{Fig:u_5}
%\end{wrapfigure}
\begin{figure}
    \centering 
   \input{Figures/Model/SolRPCongU5}
   \caption{$q_l = Q$. We have a 1-contact (red) followed by a 2-contact (orange).}
    \label{Fig:u_5}
\end{figure}
Here $u_1(x,t)$ and $u_2(x,t)$ correspond with Figure \ref{Fig:SolRPShockDiskCongestedPhase} and $u_3(x,t)$ and $u_4(x,t)$ correspond with Figure \ref{Fig:SolRPRarefDiscCongestedPhase}. 
Recall; the first family can be both genuinely nonlinear and linearly degenerate for $Q = q$. The first family is be linearly degenerate if and only if $u_l$ with $(\rho, q_l = Q)$ and thus a contact discontinuity.  If $u_r$ is on $q = Q$ then either it is the end of the first family contact discontinuity or the end of the second wave contact discontinuity which happens to be on $u_r(\rho, q_r = Q)$. The solution in this case can be seen in Figure \ref{Fig:u_5}, with corresponding solution (\ref{Eq:u_5}). See Figure \ref{Fig:SolRPDiscCongestedPhase} for the evolution of waves in the $(x,t)$-plane.

We conclude this solution of the phase transition model if initial data $u_l = (\rho_l, q_l), u_r = (\rho_r, q_r) \in \Omega_c $

Now we will demonstrate three examples, one with a shock, another with rarefaction and lastly, the double contact solution.
\begin{figure}
     \centering
     \begin{subfigure}[t]{0.35\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/Model/Plots/SysRarefacIV.png}
     \end{subfigure}
     \begin{subfigure}[t]{0.35\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/Model/Plots/SysRarefacAtTime.png}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.35\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/Model/Plots/SysRarefacRho.png}
     \end{subfigure}
     \begin{subfigure}[b]{0.35\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/Model/Plots/SysRarefacQ.png}
     \end{subfigure}
        \caption{The evolution of a solution with initial values $u_l = (0.8, 1), u_r = (0.2, 0.4)$, seen to the top left. After $t = 0.4$, we have the top right figure. In the $(x,t)$-plane, we have bottom left for $\rho(x,t)$ and bottom right for $q(x,t)$. $R = 1, Q = 0.5$.}
        \label{fig:ExampleSysRarefaction}
\end{figure} \begin{figure}
     \centering
     \begin{subfigure}[t]{0.35\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/Model/Plots/SysShockIV.png}
     \end{subfigure}
     \begin{subfigure}[t]{0.35\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/Model/Plots/SysShockAtTime.png}
     \end{subfigure}
     \hfill 
     \begin{subfigure}[b]{0.35\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/Model/Plots/SysShockRho.png}
     \end{subfigure}
     \begin{subfigure}[b]{0.35\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/Model/Plots/SysShockQ.png}
     \end{subfigure}
        \caption{The evolution of a solution with initial values $u_l = (0.3, 0.7), u_r = (0.8, 0.4)$, seen to the top left. After $t = 0.7$, we have the top right figure. In the $(x,t)$-plane, we have bottom left for $\rho(x,t)$ and bottom right for $q(x,t)$. $R = 1, Q = 0.5$.}
        \label{fig:ExampleSysShock}
\end{figure}
\begin{figure}
     \centering
     \begin{subfigure}[t]{0.35\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/Model/Plots/SysContactsIV.png}
     \end{subfigure}
     \begin{subfigure}[t]{0.35\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/Model/Plots/SysContactsAtTime.png}
     \end{subfigure}
     \hfill 
     \begin{subfigure}[b]{0.35\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/Model/Plots/SysContactsRho.png}
     \end{subfigure}
     \begin{subfigure}[b]{0.35\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/Model/Plots/SysContactsQ.png}
     \end{subfigure}
        \caption{The evolution of a solution with initial values $u_l = (0.4, 0.5 ), u_r = (0.8, 0.2)$, seen to the top left. After $t = 0.7$, we have the top right figure. In the $(x,t)$-plane, we have bottom left for $\rho(x,t)$ and bottom right for $q(x,t)$. $R = 1, Q = 0.5$}
        \label{fig:ExampleSysContact}
\end{figure}Figure \ref{fig:ExampleSysRarefaction} shows a rarefaction solution in the congested phase. This example corresponds with Figure \ref{Fig:SolRPRarefDiscCongestedPhase} and has the resulting equation $u_3(x,t)$ as seen in (\ref{Eq:correspondingSolu3u4}). Figure \ref{fig:ExampleSysRarefaction} shows, given the initial values at the top left, two slow rarefactions for $\rho$ and $q$ followed by the fast contact at the top right plot. As in the free phase, the slope is the rarefaction wave, and it moves backwards as time $t$ passes.  The two bottom plots in Figure \ref{Fig:SolRPRarefDiscCongestedPhase} shows the full solution in the $(x,t)$-plane, first for $\rho(x,t)$ to the left and then for $q(x,t)$ to he right. As expected, we can see a rarefaction fan in both cases. One should also note the difference between the rarefaction fans for $\rho$ and $q$. The rarefaction fan to the bottom left, for $\rho$, is finer than the corresponding rarefaction fan for $q$. The slope for $\rho$ is larger than for $q$, as seen in the top right plot. The reason for this is $|\rho_l - \rho_m| > |q_l - q_m|$, which results in the density rarefacting more than the momentum. 

Figure \ref{fig:ExampleSysShock} shows a shock solution in the congested phase. This example corresponds with Figure \ref{Fig:SolRPShockDiskCongestedPhase} and has the resulting equation $u_1(x,t)$ as seen in (\ref{Eq:correspondingSolu1u2}). In the top-left plot of Figure \ref{fig:ExampleSysShock}, we see the initial values corresponding to the shock solution. In the top-right plot, we can see the evolution at time $t = 0.7$. Both the slow shock and the contact have a low speed. And the two bottom plots show the full solution $\rho(x,t), q(x,t)$.

Lastly, Figure \ref{fig:ExampleSysContact} shows a double contact solution in the congested phase. This example corresponds with Figure \ref{Fig:SolRPDiscCongestedPhase} and has the resulting equation $u_5(x,t)$ as seen in (\ref{Eq:u_5}). Here we have chosen the initial condition $q_l = Q$; see the top-left plot of Figure \ref{fig:ExampleSysContact}. Moving along the first contact $q$ remains constant, while $\rho$ can vary until it reaches $\rho_m$ . This can be seen in the top-right plot. This means that $\rho(x,t)$ has three distinct values, $\rho_l, \rho_m $ and $\rho_r$ while $q$ only has two $q_l = q_m$ and $q_r$. This can also be seen in the two bottom plots, where $\rho(x,t)$ has three different values, whereas $q $ only have two. 

\newpage

\subsection{The Riemann Problem for the full model}
We combine the two sets of equations and solve the system including phase-transitions. If both $u_l, u_r \in \Omega_f$ then the solution is given in section \ref{RPFreePh}, and if $u_l, u_r \in \Omega_c$ then the solution is given in section \ref{RPCongPh}. Therefore, this section will only deal with the cases $u_l \in \Omega_f, u_r \in \Omega_c$ and $u_l \in \Omega_c, u_r \in \Omega_f$.

%Entropy for phase transitions
When introducing a phase transition to our model, we again have to deal with the lack of uniqueness in the Riemann problem, as seen before. Colombo gives an entropy condition necessary for phase transitions in section 3 in \cite{Colombo2003}, and the requirement is as follows: If $u_l \in \Omega_f$ and $u_r \in \Omega_c$ then an \textit{admissible solution} to our traffic model (\ref{Eq:phase-transition}) is a self-similar function $u:[0, \infty) \times \mathbb{R} \mapsto \Omega_f \cup \Omega_c$ such that there exists a $\Lambda \in \mathbb{R}$ with 
\begin{enumerate}[i)]
    \item $u:(t, (-\infty,\Lambda t)) \subseteq \Omega_f $ and $u:(t, (\Lambda t, \infty)) \subseteq \Omega_c $ 
    \item the functions $u_l$ and $u_r$ respectively defined by \begin{align*}
        & u_l(t,x) = \begin{cases}
        u(t,x),  \quad x < \Lambda t\\
        u(t,\Lambda t-),\quad x > \Lambda t
        \end{cases}
        & u_r(t,x) = \begin{cases}
        u(t,\Lambda t+), \quad x < \Lambda t\\
        u(t,x), \quad x > \Lambda t
        \end{cases}
    \end{align*} are restrictions of Lax solutions to the scalar and systems case respectively. 
    \item the Rankine-Hugoniot conditions 
    \begin{align}
        \Lambda (\rho (t,\Lambda t+) - \rho (t,\Lambda t-)) = \rho (t,\Lambda t+) v_c(t,\Lambda t+) - \rho (t,\Lambda t-) v_f(t,\Lambda t-)
        \label{Eq:RH_PhT}
    \end{align} are satisfied for all $t \geq 0$.
\end{enumerate}
This definition looks like our derivation of the Rankine-Hugoniot condition at the start of Chapter $2$, which is reasonable, as one can think of the disjoint domains as being separated by a discontinuity. That enables us to use the same argument as we did in our derivation. Thus, we can think of phase transitions of this type as having a shock-like behaviour.
In order to make a complete solution $u(x,t)$ for $u_l$ and $u_r$ in separate domains, we stitch together our previous results from the free- and congested phase together with the entropy condition. In this way, we can still preserve the Lax solutions and their properties at each side of the gap, as seen in $i)$. Now this stitched solution is also a new solution $ii)$. One should also note that $iii)$ only has a requirement for $\rho$. We only want to conserve the number of cars across the phases and not (necessarily) conserve momentum. In proposition $3.1$, Colombo gives another requirement. For the entire model "no $2 \times 2$ system of conservation laws may have as its Lax solutions those defined by this Riemann solver"\cite[p.~713]{Colombo2003}. This is necessary, as if we could have solved the phase transition model by only using, e.g. the congested model, we would lose uniqueness. At the end of this section, we will give an example of why this is true.
Now our goal is to find a solution of the form, for $u_l \in \Omega_f$ and $u_r \in \Omega_c$, with $u_m \in \Omega_c$
\begin{align}
    u(x,t) = \begin{cases}
        u_l & \text{ for $ x < \Lambda(u_l)t$}, \\
        u_{m} & \text{ for $ \Lambda(u_l)t < x < \lambda_1(u_{m})t$}, \\
        w_1 & \text{ for $\lambda_1(u_{m})t < x < \lambda_1(u_{m_2})t $}, \\
        u_{m_2} & \text{ for $ \lambda_1(u_{m_2})t < x < \lambda_2(u_{r})t$}, \\
        u_r & \text{ for $x > \lambda_2( u_r)t$},
    \end{cases}
    \label{Eq:APrioriFreeToCong}
\end{align}
where starting in the left state $u_l \in \Omega_f$, we travel on a phase-transition to $u_m \in \Omega_c$. From $u_m$ we take the $1$-family wave $w_1(x/t)$ to $u_{m_2}$ which we know may either be a shock or a rarefaction wave. And lastly we travel on a $2$-contact from $u_{m_2}$ to $u_r$. And for $u_r \in \Omega_f$ and $u_l \in \Omega_c$.
\begin{align}
    u(x,t) = \begin{cases}
        u_l & \text{ for $ x < \lambda_1(u_l)t$}, \\
        w_1 & \text{ for $ \lambda_1(u_l)t < x < \lambda_1(u_{m_1})t$}, \\
        u_{m_1} & \text{ for $ \lambda_1(u_{m_1})t < x < \lambda_2(u_{m_2})t$}, \\
        u_{m_2} & \text{ for $ \lambda_2(u_{m_2})t < x < \Lambda( u_r)t $}, \\
        u_r & \text{ for $x > \Lambda( u_r)t$},
    \end{cases}
    \label{Eq:APrioriCongToFree}
\end{align}
where starting in the left state $u_l \in \Omega_c$, we travel on a $1$-family wave $w_1(x/t)$ to $u_{m_1}$ $u_m \in \Omega_c$. From $u_m$ we take the $2$-contact to $u_{m_2} \in \Omega_c$. And lastly we have a phase-transition from $u_{m_2}$ to $u_r \in \Omega_f$. 

Worth noting here is that we need to determine the relationship between $\lambda_1$ and $\Lambda$, as we require a monotone increase for the entropy condition. Hence, the a priori solutions (\ref{Eq:APrioriFreeToCong}), (\ref{Eq:APrioriCongToFree}), will change when investigating the specific problem. 
%\todo{If V_c = V_f}


% -----------------------------------------------------------
% -----------------------------------------------------------

\paragraph{The Riemann Problem.}
We will first start by investigating the simplest case, where $u_l$ and $u_r$ lie on the same extension of the first wave curve. Let $ u_r \in W_1(u_l)$, and we draw the first family wave curve connecting $u_l$ and $u_r$. The different possibilities are stated below and have corresponding figures to the right. We will first state the result, and then give a proof for the following case $1.$ and $2.$ at the end. We denote the rarefaction waves with blue, shock waves with green and phase transitions with yellow.  

\begin{enumerate}
\item $u_l \in \Omega_c$, $u_r \in \Omega_f$ \newline
\newline
  \begin{minipage}[t]{0.4\linewidth}
    \begin{enumerate}
    \item $q > Q:$ Starting in $u_l$ the solution is a rarefaction wave down to $u_m$ followed by a phase transition  from $u_m$ to $u_r$.
    \item $q < Q:$ Starting in $u_l$ the solution is a shock-like phase transition $u_r$.
    \item $q = Q:$ The solution is single phase-transition acting as a contact discontinuity.
    \end{enumerate}
  \end{minipage}
  \begin{minipage}[t]{0.5\linewidth}
    \centering
    \strut\vspace*{-\baselineskip}\newline\include{Figures/Model/PhTSimpleCase1}
  \end{minipage}
\item $u_r \in \Omega_c$, $u_l \in \Omega_f$ \newline
\newline
  \begin{minipage}[t]{0.4\linewidth}
    \begin{enumerate}
    \item $q > Q:$ Starting in $u_l$ the solution is a shock-like phase transition to $u_r$.
    \item $q < Q:$ Starting in $u_l$ the solution is a phase transition to $u_m$ followed by a rarefaction wave from $u_m$ to $u_r$.
    \item $q = Q:$ The solution is single phase-transition acting as a contact discontinuity.
    \end{enumerate}
  \end{minipage}
  \begin{minipage}[t]{0.5\linewidth}
    \centering
    \strut\vspace*{-\baselineskip}\newline\include{Figures/Model/PhTSimpleCase2}
  \end{minipage}
  

Proof of $1b)$ and $1a)$: \newline
A priori one might expect $1b)$ and $2a)$ to produce in the first case a $1$-shock and then a shock-like phase transition, and in the last case a phase transition followed by a $1$-shock. We will now prove why this is not the case and the correct order of $\lambda_1$ and $\Lambda$. 
For the proof we examine in detail case $2a)$, and afterwards argue that the same proof holds for case $1b)$. In the case of $2a)$ we have $u_l \in \Omega_f$ and $u_r \in \Omega_c$. If we had $u_l \in \Omega_c$ as well, the solution would be a $1$-shock up to $u_r$, since $u_r \in W_1(u_l)$. In that case, we would have $\lambda_1(u_l) = \lambda_1(u_r)$, since the speed is constant over the shock. This holds regardless of our choice of $u_r$, so we can choose $u_r = (R, q_r)$. We will now show that the speed of the phase boundary, from $u_l \in \Omega_f$ to $u_r \in \Omega_c$ is strictly larger than the wave speed $\lambda(u_r)$. We use $q = \rho V$ when $q, \rho \in \Omega_f$. 
\begin{align*}
    \Lambda(u_l, u_r) - \lambda_1(u_r) &= \frac{\rho_l v_f(\rho_l) - \rho_r v_c(\rho_r)}{\rho_l - \rho_r} - \bigg ( \frac{2}{R} - \frac{1}{\rho_r}\bigg) (Q-q_r) + \frac{Q}{R} \\
    &= q_l - \frac{q_l^2}{RV} - q_r + \frac{q_r \rho_r}{R} - (\rho_l - \rho_r) \bigg( \frac{2q_r - Q}{R} + \frac{Q-q_r}{\rho_r}\bigg) \\
\end{align*}
Up until this point we have not assumed anything but $q_l = \rho_l V$. As argued above, we insert the assumption that $\rho_r = R$, and with no change of speed of $1$-shock. Now we get
\begin{align*}
    \Lambda(u_l, u_r) - \lambda_1(u_r) &= q_l - \frac{q_l^2}{RV} - (\rho_l - R) \frac{q_r}{R} \\
    &= 2q_l(1- \frac{q_l}{RV}) = 2q_l(1- \frac{\rho_l}{R}) > 0.
\end{align*}
And as $\rho_l < R$ we have a strict equality. This shows that we do not allow for a $1$-shock in the case $2a)$. The argument above also holds for case $1b)$. We only need to swap $u_l$ and $u_r$ in the proof above, and now we have $q_r = \rho_r V$ and we can choose $u_l = (R, q_l)$ in this case also, as we have a shock if $u_r, u_l \in \Omega_c $. 

Proof of $1c)$ and $2c)$: \newline
For the cases with the $1$-contact $1c),2c)$ the apply the same procedure. Here $q_l = q_m = q_r = Q$ and we obtain
\begin{align*}
    \Lambda - \lambda_1 &= \frac{\rho_l v_f(\rho_l) - \rho_r v_c(\rho_r)}{\rho_l - \rho_r} + \frac{Q}{R} \\
    &= Q - \frac{Q^2}{RV} - Q + \frac{\rho_m Q}{R} + \frac{Q^2}{RV} -  \frac{\rho_m Q}{R} = 0 
\end{align*}
With $\Lambda - \lambda_1 = 0 $ this phase transition acts as a contact discontinuity from $u_l$ to $u_r$. 

Proof of $1a)$ and $2b)$: \newline
For case $1a)$ we see a $1$-rarefaction up to a point $u_m$ followed by a phase transition. For this we require $\lambda_1(u_l) < \lambda_1(u_m) < \Lambda(u_m) = \Lambda(u_r)$. For the case $2b$ we see a phase transition down to $u_m$ followed by a $1$-rarefaction.  Here, we require $\Lambda(u_l) = \Lambda(u_m) < \lambda_1(u_m) < \lambda_1(u_r)$. Recall that $\lambda_1(\rho,q)$ increases as $q$ decreases, see \ref{Eq:DirectionOfLambda}.  


Now we will investigate what happens when we are below the extension of the lower first wave curve. Let $q_m(\rho) = Q + \rho/R(Q_2 - Q)$ be this lower boundary wave curve, and for simplicity let $u_r \in q_m(\rho)$.
In order to determine which behaviour we see when travelling from one phase to the other, we define the following: As in \cite{Colombo2002}, let $\check R_c$ be the smallest density on $q_m(\rho) \in \Omega_c$. We first state the result, and we will give a proof at the end. 

\item $u_l \in \Omega_f$, $u_r \in \Omega_c$ 
    \begin{enumerate}
    \item $\Lambda(\check R) \leq \lambda(\check R)$ then the solution is a phase transition from $u_l$ to $u_{m}(\check R, q_m)$, followed by a rarefaction wave $w_1$ to $u_r$. 
    \item Somewhere on the line $q_m$ there is a density $\rho_m$ where $\Lambda(\rho)$ goes from being larger than $\lambda_1(\rho)$ to being equal and then to be smaller than $\lambda_1(\rho)$. This point is $u_{m}$ and in this case we have a compound wave composed by a phase-transition, and attached to it a rarefaction wave $w_1$. 
    \item $ \Lambda( \rho) > \lambda(\rho)$, for $\check R < \rho < \rho_r$, then we will not have a middle state $u_{m}$ but travel straight to $u_r$ on a shock-like phase transition.
    \end{enumerate}
\begin{figure}[H]
    \centering
    \include{Figures/Model/PhTComplexCase1}
    \caption{Corresponding solutions in the $(\rho, q)$-plane for case $3.$}
    \label{fig:PhTComplexCase1}
\end{figure}
 
\item $u_l \in \Omega_c$, $u_r \in \Omega_f$ \newline
     $ \Lambda( \rho) < \lambda(\rho)$, for $\check R < \rho < \rho_r$, then we will not have a middle state $u_{m_1}$ but travel straight to $u_r$ on a shock-like phase transition.
\end{enumerate}

As the phase boundary may hit the congested phase for a larger $\rho$ than in the previous cases, we cannot guarantee that we first see a phase transition with speed $\Lambda$ followed by a first family wave $\lambda$, as in case $2b)$. Thus in case $3.$ we have three scenarios, where one might be a compound wave. Here, we get a part where the speed is not growing $\Lambda(u_l)$ to $\Lambda(u_m)$, and the place where the two speeds match, at $\Lambda(u_m) = \lambda_1(u_m)$, we reconnect to the first family wave and continue along that path. In $4.$, going from $u_l \in \Omega_c$ to $\Omega_f$ we get the same result as in $1b)$ a single phase transition acting as a shock. 
 
We show cases $3$ and $4$ ........... 
\begin{figure}[H]
    \centering
    \includegraphics[width=5cm]{example-image-a}
    \caption{Placeholder for proof}
    \label{fig:sampleDhehehhe}
\end{figure}

\vspace{50pt}

For case $4.$ we use the argument from $1b)$, and see that in this case we only have one possible solution.
We show this as follows, let $u_l \in \Omega_f,$ and $u_m \in \Omega_c$. When jumping from $u_l$ to $u_m$, $q$ remains constant while $\rho_l$ jumps to $\rho_m$, see Figure \ref{fig:PhTComplexCase1}. Therefore, we have $q_m = q_l = \rho_l V$ and $\rho_l = q_l/V$, this means we have the following 
\begin{align*}
    \lambda_1(u_m) - \Lambda(u_m) &= \bigg(\frac{2}{R} - \frac{1}{\rho_m} \bigg)(Q-q) - \frac{Q}{R} - \frac{\rho_l v_f(\rho_l) - \rho_m v_c(\rho_m)}{\rho_l - \rho_m} \\
    &= \frac{Q}{R} - \frac{2q_m}{R} + \frac{q_m-Q}{\rho_m} -  \frac{q_m (1 - \frac{q_m}{RV}) - (1- \frac{\rho_m}{R})q_m }{q_m/V - \rho_m} \\
    &= \bigg( \frac{Q-2q_m}{R} + \frac{q_m-Q}{\rho_m} \bigg) \bigg( \frac{q_m}{R} - \rho_m \bigg) + \frac{q_m}{R} \bigg( \frac{q_m}{R} - \rho_m \bigg) \\
    &= \frac{Q-q_m}{R} - \frac{Q-q_m}{\rho_m} \geq 0
\end{align*}
 With equality if and only if $R = \rho_m$. And as we know that $\lambda_1$ grows as $q$ increases, equality must exists for $q_m > q_l$. 

 One could also ask the question whether or not we could take, from $u_l \in \Omega_f$ to $u_r \in \Omega_c$, a middle step $u_m \in \Omega_f$ along the free phase instead of crossing straight to $u_r$. We will show that this is not an admissible solution as $\Lambda > \lambda$, where $\lambda$ is the characteristic speed in the free phase, see(\ref{Eq:CharacteristicSpeed}). Thus, we will not be able to travel up along the free phase, and then do a phase transition. 
 \begin{align*}
      \Lambda(u_l,u_m) - \lambda(u_m) &= \frac{\rho_l v_f(\rho_l) - \rho_m v_c(\rho_m)}{\rho_l - \rho_m} - V \bigg(1-  \frac{2\rho_m}{R} \bigg) \\
      &= - \frac{q_m}{R} \bigg( \frac{q_m}{R} - \rho_m \bigg) - \bigg( \frac{q_m}{R} - \rho_m \bigg)V \bigg(1- \frac{2\rho_m}{R} \bigg) \\
      &= V - \frac{q_m}{R} = V( 1- \frac{\rho_m}{R}) \geq 0 
 \end{align*}
With equality if and only if $\rho_m = R$, which does not happen in the free phase. 


In the $(x,t)$-plane we have the following waves shown in Figure \ref{fig:PhTSolInXT}. The left shows the cases $1a)$ and $3a)$, and also the case $2b)$ if one reverts the $x$-axis and letting the phase-transition come first. The middle shows the cases $1b)$, $2a)$ and $ 3c)$. Where as the only instance we have a compound wave, the right figure is the case of $3b)$. 
\begin{figure}
    \centering
    \input{Figures/Model/PhTSolInXT}
    \caption{\textit{Left:} Slow rarefaction (blue) followed by a phase transition (yellow). \textit{Middle:} A single phase transition (yellow) acting as a shock or contact. \textit{Right:} Contact discontinuity followed by a contact discontinuity, $q_l = Q$.}
    \label{fig:PhTSolInXT}
\end{figure}

We can now extend the above to include solutions with $2$-contacts as well. 

We can now state the solutions above for $u(x,t)$.
\begin{align}
    u_{1a}(x,t) = \begin{cases}
        u_l & \text{ for $ x < \lambda_1(u_r)t$}, \\
         w_1 &\text{ for $  \lambda_1(u_l)t < x < \lambda_1(u_m)$}, \\
        u_m & \text{ for $  \lambda_1(u_m)t < x < \Lambda(u_m)$}, \\
        u_r & \text{ for $x > \Lambda(u_r)t$},
    \end{cases} 
    \quad \quad 
    u_{1b}(x,t) = \begin{cases}
        u_l & \text{ for $ x < \Lambda(u_l)t$}, \\
        u_r & \text{ for $x > \Lambda( u_r)t$},
    \end{cases} 
    \label{Eq:Sol1}
\end{align}
\begin{align}
    u_{2a}(x,t) = \begin{cases}
        u_l & \text{ for $ x < \Lambda(u_l)t$}, \\
        u_r & \text{ for $x > \Lambda( u_r)t$},
    \end{cases} 
    \quad \quad 
    u_{2b}(x,t) = \begin{cases}
        u_l & \text{ for $ x < \Lambda(u_l)t$}, \\
        u_m & \text{ for $  \Lambda(u_m)t < x < \lambda_1(u_m)$}, \\
        w_1 &\text{ for $  \lambda_1(u_m)t < x < \lambda_1(u_r)$}, \\
        u_r & \text{ for $x > \lambda_1( u_r)t$},
    \end{cases} 
    \label{Eq:Sol2}
\end{align}

Lastly, we explore the following cases.
\begin{figure}
    \centering
    \input{Figures/Model/ComplexSolutions_PhaseTransitions}
    \caption{Caption}
    \label{fig:my_label}
\end{figure}

\newpage
Looking back at one of the requirements for the full model, was that we would not allow this solution by any $2 \times 2$-system of conservation laws. In the $2 \times 2$ system, we had a at most two waves in a solution, in this case we can have three waves in our solution, e.g. a phase transition, rarefaction and a $2$-contact. 
\begin{wrapfigure}[9]{r}{0.25\textwidth}
   \input{Figures/Model/NotWellPosed}
   \caption{$V_f = V_c:$ A non-well-posed solution to the Riemann problem.}
   \label{Fig:NotWellPosed}
\end{wrapfigure}
Remark: If we allow $V_f = V_c$, we stated earlier in section $3.2$, this will lead to non-well-posed solution of the Riemann problem. To see this, let $u_l = \hat u_l \in \Omega_c$, and $u_r \in \Omega_c$, see Figure \ref{Fig:NotWellPosed}. As $V_c = V_f$, and  $u_l = \hat u_l = \check u_l \in \Omega_f$. Now, according to the solution above, we can either solve this by a single $2$-contact from $\hat u_l$ to $u_r$, or by a phase transition from $\check u_l$ to $\hat u_l$ followed by a $2$-contact from $\hat u_l$ to $u_r$.

\begin{comment}


One should also note that if we are in the case of $1.$ or $2.$ and the states $u_l \in W_1(u_r)$, then we do not see a $2$-contact in the congested phase. The reason for this, is that above the lover boundary wave curve, we can reach all points $u_r \in \Omega_c$ from $u_l \in \Omega_f$. This is not the case, as we have seen, when $u_l \in \Omega_f$ is below the lower boundary wave curve. We can only reach the middle state $q_m(\rho)$, and then we need to travel to a point $u_{m_2} \in \Omega_c$ from where we can take a $2$-contact up to $u_r$. 

\end{comment}

We have now proved Proposition $3.1$ in \cite{Colombo2003}. We conclude this solution of the phase transition model if initial data in separate phases. 

Now we demonstrate three examples, $1a), 2a$) and $3b)$. 
\begin{figure}[H]
     \centering
     \begin{subfigure}[t]{0.35\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/Model/Plots/Sys1aIV.png}
     \end{subfigure}
     \begin{subfigure}[t]{0.35\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/Model/Plots/Sys1aAtTime.png}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.35\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/Model/Plots/Sys1aRho.png}
     \end{subfigure}
     \begin{subfigure}[b]{0.35\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/Model/Plots/Sys1aQ.png}
     \end{subfigure}
        \caption{The evolution of a solution with initial values $u_l = (0.79, 0.9), u_r = (0.11, 0.56)$, seen to the top left. After $t = 0.2$, we have the top right figure. In the $(x,t)$-plane, we have bottom left for $\rho(x,t)$ and bottom right for $q(x,t)$. $R = 1, Q = 0.5, V = 5, V_c = 0.5$.}
        \label{fig:Example1a}
\end{figure} \begin{figure}[H]
     \centering
     \begin{subfigure}[t]{0.35\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/Model/Plots/Sys2aIV.png}
     \end{subfigure}
     \begin{subfigure}[t]{0.35\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/Model/Plots/Sys2aAtTime.png}
     \end{subfigure}
     \hfill 
     \begin{subfigure}[b]{0.35\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/Model/Plots/Sys2aRho.png}
     \end{subfigure}
     \begin{subfigure}[b]{0.35\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/Model/Plots/Sys2aQ.png}
     \end{subfigure}
        \caption{The evolution of a solution with initial values $u_l = (0.11, 0.55), u_r = (0.8, 0.2)$, seen to the top left. After $t = 0.7$, we have the top right figure. In the $(x,t)$-plane, we have bottom left for $\rho(x,t)$ and bottom right for $q(x,t)$. 
        $R = 1, Q = 0.5, V = 5, V_c = 0.5$.}
        \label{fig:Example2a}
\end{figure}
\begin{figure}[H]
     \centering
     \begin{subfigure}[t]{0.35\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/Model/Plots/Sys3bIV.png}
     \end{subfigure}
     \begin{subfigure}[t]{0.35\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/Model/Plots/Sys3bAtTime.png}
     \end{subfigure}
     \hfill 
     \begin{subfigure}[b]{0.35\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/Model/Plots/Sys3bRho.png}
     \end{subfigure}
     \begin{subfigure}[b]{0.35\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/Model/Plots/Sys3bQ.png}
     \end{subfigure}
        \caption{The evolution of a solution with initial values $u_l = (0.08, 0.38 ), u_r = (0.9, 0.65)$, seen to the top left. After $t = 0.7$, we have the top right figure. In the $(x,t)$-plane, we have bottom left for $\rho(x,t)$ and bottom right for $q(x,t)$. $R = 1, Q = 0.5, V = 5, V_c = 0.5$.}
        \label{fig:Example3b}
\end{figure}
Figure \ref{fig:Example1a} is an example of the case $1a)$ as described above, and has the solution consisting of a rarefaction followed by a phase transition. Its solution is given by $u_{1a}(x,t)$ as seen in (\ref{Eq:Sol1}). The top left plot of Figure \ref{fig:Example1a} shows the initial value $u_l = (\rho_l, q_l)$. Top right shows the solution at $t = 0.2$. Here we can see a steep rarefaction wave for $\rho$, followed by a contact discontinuity. The rarefaction wave for $q$ is not so steep. This can be seen in the bottom two plots, where the rarefaction fan for $\rho$ is much finer than the fan for $q$.  The $2$-contact is fast, and will disappear after $t=0.4$, as seen at the bottom two plots. This solution represents a car in a congested part of the road, and which gradually accelerates such that the space to nearby cars increase. This is what we see as the rarefaction wave. Then there is a change of pace, a phase transition, and we are in the free phase. 

Figure \ref{fig:Example2a} the case $2a)$ as described above, has as is solution a single shock like phase transition. It has the resulting equation $u_{2a}(x,t)$ as seen in (\ref{Eq:Sol1}).
In the top left plot of Figure \ref{fig:ExampleSysShock} we see the initial values. The top right plot shows the solution at $t = 0.7$. We can see that the phase transition is propagating backwards. This is reasonable, as the phase boundary should disappear as we move into the congested phase. The two bottom plots show the solution $\rho(x,t), q(x,t)$. We can see, as expected, the single phase boundary propagating backwards, and a clear separation of the two phases. 

Lastly, the Figure \ref{fig:Example3b} shows the solution where we have a phase transition and attached to it, a rarefaction wave, followed by a $2$-contact. This is the case $3b)$ described above and has the same solution equation as $u_{1a}$ and $u_{2b}$, see \ref{Eq:Sol1}, \ref{Eq:Sol2}. The top left plot of Figure \ref{fig:Example3b} shows the initial values. After a time $t = 0.7$, we can see the solution in the top right plot. Starting with $q(x, t = 0.7)$ we see a phase transition happening at $x = -0.34$, and attached to it a rarefaction wave down to $u_m$. Here $q$ is decreasing, as we have seen in the Figure \ref{fig:PhTComplexCase1}. At $x = 0.05$ we see the contact discontinuity up to $u_r$. In the case of $\rho(x, t = 0.7)$, we see the phase transition by followed by a positive rarefaction wave. It may be more appropriate to call it a compression wave. This is in full agreement with what we expected from the Figure \ref{fig:PhTComplexCase1}, when we first described this compound wave. here we can see the value of $q$ is decreasing along the $1$-family wave curve, and increasing $\rho$ along the $1$-family wave curve. The two bottom plots show the full solution for $\rho(x,t)$ and $q(x,t)$.

\begin{comment}

\begin{figure} \centering 
\begin{minipage}{.35\textwidth}
\begin{tikzpicture}
% coordinates
% Omega_c
\filldraw[fill=black!2, draw=black!50] plot [tension = 1] coordinates { (0,1.7) (1.3,1.7) (1.3,0.3) (0, 0.3) };
\draw[<->] (0,0) -- (0,2) node[anchor= south east] {$\omega_2$};
\draw[->] (-0.2,1) -- (2,1) node[anchor= north west] {$\omega_1$};
% rarefactions
%\draw[cyan!50] (0, 1.5) -- (0.5, 1.5) ;

%\draw[cyan] (0.5, 1.5) -- (1.3, 1.5)  ;
%\filldraw[black] (0.5, 1.5) circle (0.5pt) node[anchor = south east]{$\omega_r^1$} ;

%\draw[lime] (0, 0.5) -- (1, 0.5) ;
%\draw[line width=0.25mm,lime] (1, 0.7) -- (1.3, 0.7) ;
%\filldraw[black] (1, 0.7)  circle (0.5pt) node[anchor = east]{$\omega_r^2$} ;

% contacts
\draw[orange] (0.5, 1.7) -- (0.5, 0.3) ;
%\draw[orange] (1, 1.7) -- (1, 0.3) ;
\draw[yellow] (1.7, 0.1) -- (1.1, 0.3);

% free ph line
\draw[magenta!50] (1.7, 0) -- (1.7, 1.7); 
\node[magenta!50] at (1.7, 2) {$V_f$};
%\filldraw[black] (1.3, 0.3)  circle (0.5pt) node[anchor = north]{$\hat \omega$} ;
\filldraw[black] (1.1, 0.3)  circle (0.5pt) node[anchor = north]{$\omega_m$} ;
\filldraw[black] (0.5, 0.3)  circle (0.5pt) node[anchor = north]{$\omega_r$} ;
\filldraw[black] (1.7, 0.1)  circle (0.5pt) node[anchor = west]{$\omega_l$} ;
\end{tikzpicture}
\caption{The point $\omega_l$ below the lower boundary wave curve}
\label{Fig:solPhTransOutsidedomainOmega1}
\end{minipage}
\quad \quad \quad \quad 
\begin{minipage}{.35\textwidth}
\begin{tikzpicture}
% coordinates
    \filldraw[fill=black!2, draw=black!50] plot [tension = 1] coordinates { (0.5,1.25) (2,2) (2,0.2) (0.38, 0.81) (0.5,1.25)};
    \draw[->] (0,-0.2) -- (0,2.3) node[anchor=south east] {$q$};
    \draw[red!50, domain=0:0.7]  plot[id=x] function{x*(3*x+1)}  node[above] {$v_c(\rho)$};
    \draw[magenta!50] (0,0) -- (0.2,1.25) node[anchor = south] {$V_f$};
    %\node[magenta!50] at (0.3,2.5) {$V_f$};
    \filldraw[black] (0.09,0.6) circle (0.5pt) node[anchor = north west]{$u_l$} ;
    % \node at (1,1) {$\Omega_c$};
     \draw[->] (-0.2,0) -- (2.3,0) node[anchor=north west] {$\rho$};
    \node at (2,-0.2) {$R$};
     \node at (-0.2,2) {$Q_1$};
     \node at (-0.2,0.2) {$Q_2$};
     \node at (-0.2,1) {$Q$};
     \draw[loosely dotted] (0,1) -- (2,1);
     \draw[loosely dotted] (0,2) -- (2,2);
     \draw[loosely dotted] (0,0.2) -- (2,0.2);
     % rarefactions and shocks
    %\draw[lime] (1.05, 1.33) -- (2, 1.6) ;
    %\draw[<-][cyan!50] (0.42, 1.19) -- (1, 1.33) ;
    
    %\draw[->][lime] (1.48,0.4)  -- (2, 0.2) ;
    %\draw[-][cyan!50] (0.37, 0.83) -- (1.48,0.4)  ;
    \draw[yellow] (0.09,0.6) -- (0.9, 0.6);
    %middlepoints
     \filldraw[black] (0.9, 0.6) circle (0.5pt) node[anchor = north]{$u_m$} ;
     \filldraw[black] (1.48,0.4) circle (0.5pt) node[anchor =  west]{$u_r$} ;
    %endpoints
    %\filldraw[black] (1.05,1.33) circle (0.5pt) node[anchor = south east]{$u_r^1$} ;
    %\filldraw[black] (1.55,0.56) circle (0.5pt) node[anchor = south west]{$u_r^2$} ;
    % contacts
    \draw[ orange!50, domain=0:1.86]  plot[id=x] function{(x/1.38)*(2-1.38)/(2-x)*0.33};
    %\draw[ orange!50, domain=0:1.28]  plot[id=x] function{(x/1.16)*(2-1.16)/(2-x)*1.63};
     
\end{tikzpicture}
\caption{$u_l$ below the lower boundary wave curve }
\label{Fig:Fig:solPhTransOutsidedomainRhoQ1}
\end{minipage}
\end{figure}
\end{comment}

%\caption{Wave solutions from two starting points $\omega_l^3$ and $\omega_l^3$.}
%\label{Fig:FullSol_ic_ww3}
%\end{wrapfigure}

\begin{comment}

\begin{figure} \centering 
\begin{minipage}{.35\textwidth}
\begin{tikzpicture}
% coordinates
% Omega_c
\filldraw[fill=black!2, draw=black!50] plot [tension = 1] coordinates { (0,1.7) (1.3,1.7) (1.3,0.3) (0, 0.3) };
\draw[<->] (0,0) -- (0,2) node[anchor= south east] {$\omega_2$};
\draw[->] (-0.2,1) -- (2,1) node[anchor= north west] {$\omega_1$};
% rarefactions
%\draw[cyan!50] (0, 1.5) -- (0.5, 1.5) ;

\draw[cyan] (0.5, 1.5) -- (1.3, 1.5)  ;
\filldraw[black] (0.5, 1.5) circle (0.5pt) node[anchor = south east]{$\omega_r^1$} ;

%\draw[lime] (0, 0.5) -- (1, 0.5) ;
\draw[line width=0.25mm,lime] (1, 0.7) -- (1.3, 0.7) ;
\filldraw[black] (1, 0.7)  circle (0.5pt) node[anchor = east]{$\omega_r^2$} ;

% contacts
\draw[orange] (0.5, 1.7) -- (0.5, 0.3) ;
\draw[orange] (1, 1.7) -- (1, 0.3) ;

% free ph line
\draw[magenta!50] (1.7, 0) -- (1.7, 1.7); 
\node[magenta!50] at (1.7, 2) {$V_f$};
%\filldraw[black] (1.3, 0.3)  circle (0.5pt) node[anchor = north]{$\hat \omega$} ;
\filldraw[black] (1, 0.3)  circle (0.5pt) node[anchor = north]{$\hat \omega_m^2$} ;
\filldraw[black] (0.5, 0.3)  circle (0.5pt) node[anchor = north]{$\hat \omega_m^1$} ;
\filldraw[black] (1.7, 0.1)  circle (0.5pt) node[anchor = west]{$\omega_l$} ;
\end{tikzpicture}
\caption{The point $\omega_l$ below the lower boundary wave curve}
\label{Fig:solPhTransOutsidedomainOmega2}
\end{minipage}
\quad \quad \quad \quad 
\begin{minipage}{.35\textwidth}
\begin{tikzpicture}
% coordinates
    \filldraw[fill=black!2, draw=black!50] plot [tension = 1] coordinates { (0.5,1.25) (2,2) (2,0.2) (0.38, 0.81) (0.5,1.25)};
    \draw[->] (0,-0.2) -- (0,2.3) node[anchor=south east] {$q$};
    \draw[red!50, domain=0:0.7]  plot[id=x] function{x*(3*x+1)}  node[above] {$v_c(\rho)$};
    \draw[magenta!50] (0,0) -- (0.2,1.25) node[anchor = south] {$V_f$};
    %\node[magenta!50] at (0.3,2.5) {$V_f$};
    \filldraw[black] (0.09,0.5) circle (0.5pt) node[anchor = north west]{$u_l$} ;
    % \node at (1,1) {$\Omega_c$};
     \draw[->] (-0.2,0) -- (2.3,0) node[anchor=north west] {$\rho$};
    \node at (2,-0.2) {$R$};
     \node at (-0.2,2) {$Q_1$};
     \node at (-0.2,0.2) {$Q_2$};
     \node at (-0.2,1) {$Q$};
     \draw[loosely dotted] (0,1) -- (2,1);
     \draw[loosely dotted] (0,2) -- (2,2);
     \draw[loosely dotted] (0,0.2) -- (2,0.2);
     % rarefactions and shocks
    \draw[lime] (1.05, 1.33) -- (2, 1.6) ;
    \draw[<-][cyan!50] (0.42, 1.19) -- (1, 1.33) ;
    
    \draw[->][lime] (1.55,0.56)  -- (2, 0.4) ;
    \draw[-][cyan!50] (0.37, 0.85) -- (1.55,0.56)  ;
    %middlepoints
     %\filldraw[black] (0.78, 0.68) circle (0.5pt) node[anchor = north]{$u_m^1$} ;
     %\filldraw[black] (1.55,0.56) circle (0.5pt) node[anchor =  west]{$u_m^2$} ;
    %endpoints
    \filldraw[black] (1.05,1.33) circle (0.5pt) node[anchor = south east]{$u_r^1$} ;
    \filldraw[black] (1.55,0.56) circle (0.5pt) node[anchor = south west]{$u_r^2$} ;
    % contacts
    \draw[ orange!50, domain=0:1.86]  plot[id=x] function{(x/1.38)*(2-1.38)/(2-x)*0.33};
    \draw[ orange!50, domain=0:1.28]  plot[id=x] function{(x/1.16)*(2-1.16)/(2-x)*1.63};
     
\end{tikzpicture}
\caption{$u_l$ below the lower boundary wave curve }
\label{Fig:Fig:solPhTransOutsidedomainRhoQ2}
\end{minipage}
\end{figure}


\begin{tikzpicture} %[scale=0.8, every node/.style={transform shape}]
% coordinates
\draw[<->] (0,0) -- (0,2) node[anchor= south east] {$\omega_2$};
\draw[->] (-0.2,1) -- (2,1) node[anchor= north west] {$\omega_1$};
% rarefactions
%\draw[cyan!50] (0, 1.5) -- (0.5, 1.5) ;
\draw[cyan!50] (0.5, 1.5) -- (1.3, 1.5)  ;
\filldraw[black] (0.5, 1.5) circle (0.5pt) node[anchor = south east]{$\omega_r^1$} ;

%\draw[lime] (0, 0.5) -- (1, 0.5) ;
\draw[lime] (1, 0.5) -- (1.3, 0.5) ;
\filldraw[black] (1, 0.5)  circle (0.5pt) node[anchor = north east]{$\omega_r^2$} ;

% contacts
\draw[orange!50] (0.5, 1.7) -- (0.5, 0.3) ;
\draw[orange!50] (1, 1.7) -- (1, 0.3) ;

% free ph line
\draw[magenta!50] (1.5, 0.1) -- (1.5, 1.7); 
\node[magenta!50] at (1.5, 2) {$V_f$};
\filldraw[black] (1.5, 1.5)  circle (0.5pt) node[anchor =  west]{$\omega_l^1$} ;
\filldraw[black] (1.5, 0.5)  circle (0.5pt) node[anchor = west]{$\omega_l^2$} ;
\end{tikzpicture}
\end{comment}

\newpage

\section{Qualitative Properties}
Consider the LWR model with initial condition $\rho_l$ for $ x \leq 0$ and $\rho_r = R$ for $ x > 0$. This is an instance of the traffic light problem, with the traffic light at $x = 0$. The solution, as we derived in Section $3.1$, is a shock with negative propagation speed. Physically, we can interpret this as whenever a driver reaches the queue, he or she breaks and immediately stops. The shock, as well as the queue, propagates backwards as time passes. This description works well when there are either few fast cars or many slow cars. Looking at the corresponding case in our phase transition model, we have the following $u_l = (\rho_l, q_l)$ for $ x < 0$ and $u_r = (R, q_r)$ for $ x > 0$. As we have seen in Section $3.3$, there exists two thresholds densities $\rho_l^-$ and $\rho_l^+$ such that if
\begin{itemize}
    \item $\rho_l \leq \rho_l^-$ or $\rho_l > \rho_l^+$, we see the same behaviour as in the LWR case. 
    \item $\rho_l^- < \rho_l < \rho_l^+$, the solution is a phase transition possibly attached to a rarefaction wave.
\end{itemize}
In the last case, coming from the phase transition model, we allow for solutions where drivers brake and the speed smoothly decreases. This holds independently of the value of $q_r \in [Q_1, Q_2]$\cite{Colombo2003}. This solution is in agreement with our experience when driving and entering heavily congested regions of the road. It is clear that our stitching of the two solutions works well, and we have managed to preserve the properties of the LWR model and introduce new properties from a congested phase. We have a similar result if the traffic light turns green \cite{Colombo2003}. Then we will gradually accelerate and then enter the free phase, see Figure \ref{fig:RhoVFigure}. This solution is a rarefaction wave followed by a phase transition. 

At the start of Chapter $3$, we presented Figure \ref{fig:Kerner}, showing collected data from different countries. Comparing Figure \ref{fig:Kerner}b) to our fundamental diagram in the $(\rho, \rho v)$-plane, see Figure \ref{fig:RhoVFigure}, it is clear that our model coincides with the observations. Moreover, with the properties investigated, the results presented are one step closer to modelling the complex behaviour of traffic. However, one drawback of the model is the lack of well-posedness if $V_c = V_f$. Here, the speed limit of the congested phase and the free phase coincide. With our description, it is unclear which behaviour we would like to see in the case of $V_c = V_f$. Should there now be no free phase, or should there be no congested phase? 

Kerner also suggests dividing the congested phase into two different phases; wide-moving jams and synchronised traffic flow. Colombo argues in his paper from $2003$ that this distinction cannot be made in this case, as "[...] the term \textit{phase} characterizes suitable subsets of the space where the conserved quantities (or equivalent coordinates) may vary, with different phases corresponding to disjoint sets"\cite[p.~717]{Colombo2003}. In our case, we do not have two disjoint domains in our congested phase. However, we are still able to satisfy the qualitative features Kerner describes as synchronised traffic flow and wide-moving jams. Synchronised traffic flow can be divided into three types, where one is "States where only the average vehicle speed is stationary ('homogeneous-in- speed-states')" \cite[p. 260]{KernerHelbing}. This behaviour is what we see across a $2$-contact in the congested phase. Here the speed remains constant across the discontinuity. %A second type is "Stationary and homogeneous states where both the average speed and the flow rate are stationary during a relatively long time interval"\cite[p. 260]{KernerHelbing}. Recall that in the case of $q_l = Q$ we have a $1-$ contact discontinuity. Across this contact, neither speed nor 
In the case of wide-moving jams, "The vehicle speed and the flow rate inside a wide jam are either zero or negligible for the jam propagation" \cite[p. 265]{KernerHelbing}. Recall that in the case of $q_l = Q$, we have a $1$-contact along this line. Furthermore, the speed is constant along this contact, which fits Kerner's description of the wide-jam. Furthermore, near to this line, a sharp increase in $\rho$ may persist for a long time \cite{Colombo2003}. This is seen as a $1$-rarefaction wave, which propagates slowly.

The Riemann solver Colombo proposes in \cite{Colombo2003} does not suffer from the nonphysical effects in previous second-order models. In  Aw and Rascles paper from $2000$, see \cite{Aw2000ResurrectionO}, they state that  "the previous “second order” models, i.e., models with two equations (mass and “momentum”), lead to nonphysical effects, probably because they try to mimic the gas dynamics equations, with an unrealistic dependence on the acceleration with respect to the space derivative of the “pressure.” \cite[p.~916] {Aw2000ResurrectionO}. In the previous second-order models, we have seen both negative densities and speeds \cite{GaravelloMauro2006Tfon} and that the characteristic speed can be faster than the speed of the car. Unbounded characteristic speeds leads to unrealistic effects described in \cite[p. ~918]{Aw2000ResurrectionO}, where the driver slows down when seeing denser traffic moving at a higher speed in front of her. Here, any reasonable driver would accelerate rather than slow down. Our investigation of this phase transition model concluded that we do not have a problem with negative densities or momentum. We have also concluded that no information travels faster than vehicles, ensuring that we do not see the unrealistic phenomena described above \cite{Aw2000ResurrectionO}.

Colombo proved the Cauchy problem admits a global solution in time, without any assumptions on the number of phase boundaries or the smallness of initial data \cite{Colombo2003}. In the proof of the Cauchy problem, the main tool is wave front-tracking, and it is shown that the model admits a bounded variation weak solution, and it holds globally for all times. Furthermore, global well-posedness for conservation laws developing phase transitions was shown by Colombo, Goatin and Priuli in $2007$, using standard Riemann semigroups; see  \cite{ColomboGoatinPriuli}. 


\section{Conclusion and Further Work}
This project report presents a model for traffic flow on a single-lane road, with the needed background theory. The model can be seen as an extension of the classical LWR-model. We have shown that our new model can reproduce traffic phenomena we have previously seen in the LWR model, like the traffic light problem, and new phenomena we see in congested traffic.  Moreover, the model is in good agreement with experimental observations and the theoretical implications proposed by Kerner.  However, one drawback of the model is the lack of well-posedness if the speed limit of the free phase and the congested phase coincide. 

Further work includes optimal control, applying the model on networks and also on multiple lanes. It may also be interesting to try and combine with multi-population models. 

\newpage

\printbibliography

\end{document}


